[2023-10-26 17:11:42,256] [INFO] [real_accelerator.py:158:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2023-10-26 17:11:45,377] [WARNING] [runner.py:203:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2023-10-26 17:11:45,452] [INFO] [runner.py:570:main] cmd = /usr/bin/python -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMCwgMSwgMiwgMywgNCwgNSwgNiwgN119 --master_addr=127.0.0.1 --master_port=29500 --enable_each_rank_log=None src/main.py --model vit_base_patch8_224 --dataset cifar10 --one_image --exp_name Cheatsheet-cifar10-vit_base_patch8_224-CS_SIZE_8-GlobalBatch128-RandomizeSheet --randomize_sheet --batch_size 128 --cheatsheet --cs_size 8 --deepspeed_config src/conf/ds_config.json --test_interval 1
[2023-10-26 17:11:49,293] [INFO] [real_accelerator.py:158:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2023-10-26 17:11:51,103] [INFO] [launch.py:138:main] 0 NCCL_VERSION=2.18.1
[2023-10-26 17:11:51,103] [INFO] [launch.py:138:main] 0 NCCL_SOCKET_IFNAME=eth0
[2023-10-26 17:11:51,103] [INFO] [launch.py:138:main] 0 NCCL_DEBUG_SUBSYS=GRAPH,INIT,ENV
[2023-10-26 17:11:51,103] [INFO] [launch.py:138:main] 0 NCCL_DEBUG=WARN
[2023-10-26 17:11:51,103] [INFO] [launch.py:138:main] 0 NCCL_TESTS_TAG=v2.11.0
[2023-10-26 17:11:51,103] [INFO] [launch.py:138:main] 0 NCCL_IB_TIMEOUT=22
[2023-10-26 17:11:51,103] [INFO] [launch.py:138:main] 0 NCCL_IB_DISABLE=0
[2023-10-26 17:11:51,103] [INFO] [launch.py:138:main] 0 NCCL_TOPO_FILE=/opt/microsoft/ndv4-topo.xml
[2023-10-26 17:11:51,103] [INFO] [launch.py:145:main] WORLD INFO DICT: {'localhost': [0, 1, 2, 3, 4, 5, 6, 7]}
[2023-10-26 17:11:51,103] [INFO] [launch.py:151:main] nnodes=1, num_local_procs=8, node_rank=0
[2023-10-26 17:11:51,103] [INFO] [launch.py:162:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0, 1, 2, 3, 4, 5, 6, 7]})
[2023-10-26 17:11:51,103] [INFO] [launch.py:163:main] dist_world_size=8
[2023-10-26 17:11:51,103] [INFO] [launch.py:165:main] Setting CUDA_VISIBLE_DEVICES=0,1,2,3,4,5,6,7
[2023-10-26 17:11:59,538] [INFO] [real_accelerator.py:158:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2023-10-26 17:11:59,577] [INFO] [real_accelerator.py:158:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2023-10-26 17:11:59,612] [INFO] [real_accelerator.py:158:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2023-10-26 17:12:00,104] [INFO] [real_accelerator.py:158:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2023-10-26 17:12:03,776] [INFO] [real_accelerator.py:158:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2023-10-26 17:12:03,778] [INFO] [real_accelerator.py:158:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2023-10-26 17:12:04,401] [INFO] [real_accelerator.py:158:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2023-10-26 17:12:05,362] [INFO] [real_accelerator.py:158:get_accelerator] Setting ds_accelerator to cuda (auto detect)
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
[2023-10-26 17:12:11,045] [INFO] [comm.py:637:init_distributed] cdb=None
[2023-10-26 17:12:11,045] [INFO] [comm.py:668:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[2023-10-26 17:12:11,156] [INFO] [comm.py:637:init_distributed] cdb=None
[2023-10-26 17:12:11,252] [INFO] [comm.py:637:init_distributed] cdb=None
[2023-10-26 17:12:11,566] [INFO] [comm.py:637:init_distributed] cdb=None
[2023-10-26 17:12:11,826] [INFO] [comm.py:637:init_distributed] cdb=None
[2023-10-26 17:12:11,904] [INFO] [comm.py:637:init_distributed] cdb=None
[2023-10-26 17:12:11,912] [INFO] [comm.py:637:init_distributed] cdb=None
[2023-10-26 17:12:11,995] [INFO] [comm.py:637:init_distributed] cdb=None
wandb: Currently logged in as: sultan-m-rashed. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.15.12 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.6
wandb: Run data is saved locally in /mnt/azureml/cr/j/f7c7fad8966641b09778efdde55f303c/exe/wd/CheatSheet/wandb/run-20231026_171213-3oq2t7f8
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run comfy-jazz-21
wandb: ‚≠êÔ∏è View project at https://wandb.ai/sultan-m-rashed/cheatsheet
wandb: üöÄ View run at https://wandb.ai/sultan-m-rashed/cheatsheet/runs/3oq2t7f8
wandb: Adding directory to artifact (./src/conf)... Done. 0.0s
NCCL version 2.18.1+cuda12.1
[2023-10-26 17:13:18,761] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed info: version=0.11.1, git-hash=unknown, git-branch=unknown
[2023-10-26 17:13:37,491] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
Using /root/.cache/torch_extensions/py310_cu121 as PyTorch extensions root...
Using /root/.cache/torch_extensions/py310_cu121 as PyTorch extensions root...
Using /root/.cache/torch_extensions/py310_cu121 as PyTorch extensions root...
Using /root/.cache/torch_extensions/py310_cu121 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /root/.cache/torch_extensions/py310_cu121/fused_adam/build.ninja...
Building extension module fused_adam...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module fused_adam...
Time to load fused_adam op: 0.07395720481872559 seconds
/usr/local/lib/python3.10/dist-packages/deepspeed/ops/adam/fused_adam.py:96: UserWarning: The torch.cuda.*DtypeTensor constructors are no longer recommended. It's best to use methods such as torch.tensor(data, dtype=*, device='cuda') to create tensors. (Triggered internally at /opt/pytorch/pytorch/torch/csrc/tensor/python_tensor.cpp:82.)
  self._dummy_overflow_buf = get_accelerator().IntTensor([0])
Using /root/.cache/torch_extensions/py310_cu121 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /root/.cache/torch_extensions/py310_cu121/fused_adam/build.ninja...
Building extension module fused_adam...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
Using /root/.cache/torch_extensions/py310_cu121 as PyTorch extensions root...
ninja: no work to do.
Loading extension module fused_adam...
Time to load fused_adam op: 0.0727226734161377 seconds
/usr/local/lib/python3.10/dist-packages/deepspeed/ops/adam/fused_adam.py:96: UserWarning: The torch.cuda.*DtypeTensor constructors are no longer recommended. It's best to use methods such as torch.tensor(data, dtype=*, device='cuda') to create tensors. (Triggered internally at /opt/pytorch/pytorch/torch/csrc/tensor/python_tensor.cpp:82.)
  self._dummy_overflow_buf = get_accelerator().IntTensor([0])
Using /root/.cache/torch_extensions/py310_cu121 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /root/.cache/torch_extensions/py310_cu121/fused_adam/build.ninja...
Building extension module fused_adam...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module fused_adam...
Time to load fused_adam op: 0.07419204711914062 seconds
/usr/local/lib/python3.10/dist-packages/deepspeed/ops/adam/fused_adam.py:96: UserWarning: The torch.cuda.*DtypeTensor constructors are no longer recommended. It's best to use methods such as torch.tensor(data, dtype=*, device='cuda') to create tensors. (Triggered internally at /opt/pytorch/pytorch/torch/csrc/tensor/python_tensor.cpp:82.)
  self._dummy_overflow_buf = get_accelerator().IntTensor([0])
Loading extension module fused_adam...
Time to load fused_adam op: 0.30220603942871094 seconds
/usr/local/lib/python3.10/dist-packages/deepspeed/ops/adam/fused_adam.py:96: UserWarning: The torch.cuda.*DtypeTensor constructors are no longer recommended. It's best to use methods such as torch.tensor(data, dtype=*, device='cuda') to create tensors. (Triggered internally at /opt/pytorch/pytorch/torch/csrc/tensor/python_tensor.cpp:82.)
  self._dummy_overflow_buf = get_accelerator().IntTensor([0])
Loading extension module fused_adam...
Time to load fused_adam op: 0.3017148971557617 seconds
/usr/local/lib/python3.10/dist-packages/deepspeed/ops/adam/fused_adam.py:96: UserWarning: The torch.cuda.*DtypeTensor constructors are no longer recommended. It's best to use methods such as torch.tensor(data, dtype=*, device='cuda') to create tensors. (Triggered internally at /opt/pytorch/pytorch/torch/csrc/tensor/python_tensor.cpp:82.)
  self._dummy_overflow_buf = get_accelerator().IntTensor([0])
Loading extension module fused_adam...
Time to load fused_adam op: 0.30217623710632324 seconds
/usr/local/lib/python3.10/dist-packages/deepspeed/ops/adam/fused_adam.py:96: UserWarning: The torch.cuda.*DtypeTensor constructors are no longer recommended. It's best to use methods such as torch.tensor(data, dtype=*, device='cuda') to create tensors. (Triggered internally at /opt/pytorch/pytorch/torch/csrc/tensor/python_tensor.cpp:82.)
  self._dummy_overflow_buf = get_accelerator().IntTensor([0])
Using /root/.cache/torch_extensions/py310_cu121 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /root/.cache/torch_extensions/py310_cu121/fused_adam/build.ninja...
Building extension module fused_adam...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module fused_adam...
Time to load fused_adam op: 0.07558917999267578 seconds
/usr/local/lib/python3.10/dist-packages/deepspeed/ops/adam/fused_adam.py:96: UserWarning: The torch.cuda.*DtypeTensor constructors are no longer recommended. It's best to use methods such as torch.tensor(data, dtype=*, device='cuda') to create tensors. (Triggered internally at /opt/pytorch/pytorch/torch/csrc/tensor/python_tensor.cpp:82.)
  self._dummy_overflow_buf = get_accelerator().IntTensor([0])
[2023-10-26 17:13:38,932] [INFO] [logging.py:96:log_dist] [Rank 0] Using DeepSpeed Optimizer param name adam as basic optimizer
[2023-10-26 17:13:38,932] [INFO] [logging.py:96:log_dist] [Rank 0] Removing param_group that has no 'params' in the basic Optimizer
[2023-10-26 17:13:38,937] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Basic Optimizer = FusedAdam
[2023-10-26 17:13:38,937] [INFO] [logging.py:96:log_dist] [Rank 0] Creating BF16 optimizer
Loading extension module fused_adam...
Time to load fused_adam op: 0.3025205135345459 seconds
/usr/local/lib/python3.10/dist-packages/deepspeed/ops/adam/fused_adam.py:96: UserWarning: The torch.cuda.*DtypeTensor constructors are no longer recommended. It's best to use methods such as torch.tensor(data, dtype=*, device='cuda') to create tensors. (Triggered internally at /opt/pytorch/pytorch/torch/csrc/tensor/python_tensor.cpp:82.)
  self._dummy_overflow_buf = get_accelerator().IntTensor([0])
[2023-10-26 17:13:39,115] [INFO] [utils.py:802:see_memory_usage] begin bf16_optimizer
[2023-10-26 17:13:39,116] [INFO] [utils.py:803:see_memory_usage] MA 0.16 GB         Max_MA 0.16 GB         CA 0.18 GB         Max_CA 0 GB 
[2023-10-26 17:13:39,116] [INFO] [utils.py:810:see_memory_usage] CPU Virtual Memory:  used = 32.5 GB, percent = 1.8%
[2023-10-26 17:13:39,447] [INFO] [utils.py:802:see_memory_usage] before initializing group 0
[2023-10-26 17:13:39,448] [INFO] [utils.py:803:see_memory_usage] MA 0.16 GB         Max_MA 0.16 GB         CA 0.18 GB         Max_CA 0 GB 
[2023-10-26 17:13:39,449] [INFO] [utils.py:810:see_memory_usage] CPU Virtual Memory:  used = 32.5 GB, percent = 1.8%
[2023-10-26 17:13:39,782] [INFO] [utils.py:802:see_memory_usage] after initializing group 0
[2023-10-26 17:13:39,784] [INFO] [utils.py:803:see_memory_usage] MA 0.52 GB         Max_MA 0.52 GB         CA 0.72 GB         Max_CA 1 GB 
[2023-10-26 17:13:39,784] [INFO] [utils.py:810:see_memory_usage] CPU Virtual Memory:  used = 32.5 GB, percent = 1.8%
[2023-10-26 17:13:40,141] [INFO] [utils.py:802:see_memory_usage] before initialize_optimizer
[2023-10-26 17:13:40,143] [INFO] [utils.py:803:see_memory_usage] MA 0.52 GB         Max_MA 0.52 GB         CA 0.72 GB         Max_CA 1 GB 
[2023-10-26 17:13:40,143] [INFO] [utils.py:810:see_memory_usage] CPU Virtual Memory:  used = 32.5 GB, percent = 1.8%
[2023-10-26 17:13:40,397] [INFO] [utils.py:802:see_memory_usage] end initialize_optimizer
[2023-10-26 17:13:40,398] [INFO] [utils.py:803:see_memory_usage] MA 0.6 GB         Max_MA 0.6 GB         CA 0.8 GB         Max_CA 1 GB 
[2023-10-26 17:13:40,399] [INFO] [utils.py:810:see_memory_usage] CPU Virtual Memory:  used = 32.5 GB, percent = 1.8%
[2023-10-26 17:13:40,672] [INFO] [utils.py:802:see_memory_usage] end bf16_optimizer
[2023-10-26 17:13:40,674] [INFO] [utils.py:803:see_memory_usage] MA 0.6 GB         Max_MA 0.6 GB         CA 0.8 GB         Max_CA 1 GB 
[2023-10-26 17:13:40,674] [INFO] [utils.py:810:see_memory_usage] CPU Virtual Memory:  used = 32.5 GB, percent = 1.8%
[2023-10-26 17:13:40,674] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Final Optimizer = adam
[2023-10-26 17:13:40,674] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed using configured LR scheduler = WarmupLR
[2023-10-26 17:13:40,675] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed LR Scheduler = <deepspeed.runtime.lr_schedules.WarmupLR object at 0x153624277b80>
[2023-10-26 17:13:40,675] [INFO] [logging.py:96:log_dist] [Rank 0] step=0, skipped=0, lr=[0.0001], mom=[[0.9, 0.999]]
[2023-10-26 17:13:40,676] [INFO] [config.py:968:print] DeepSpeedEngine configuration:
[2023-10-26 17:13:40,676] [INFO] [config.py:972:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2023-10-26 17:13:40,676] [INFO] [config.py:972:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2023-10-26 17:13:40,676] [INFO] [config.py:972:print]   amp_enabled .................. False
[2023-10-26 17:13:40,677] [INFO] [config.py:972:print]   amp_params ................... False
[2023-10-26 17:13:40,677] [INFO] [config.py:972:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2023-10-26 17:13:40,677] [INFO] [config.py:972:print]   bfloat16_enabled ............. True
[2023-10-26 17:13:40,677] [INFO] [config.py:972:print]   checkpoint_parallel_write_pipeline  False
[2023-10-26 17:13:40,677] [INFO] [config.py:972:print]   checkpoint_tag_validation_enabled  True
[2023-10-26 17:13:40,677] [INFO] [config.py:972:print]   checkpoint_tag_validation_fail  False
[2023-10-26 17:13:40,677] [INFO] [config.py:972:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x153698708be0>
[2023-10-26 17:13:40,677] [INFO] [config.py:972:print]   communication_data_type ...... None
[2023-10-26 17:13:40,678] [INFO] [config.py:972:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2023-10-26 17:13:40,678] [INFO] [config.py:972:print]   curriculum_enabled_legacy .... False
[2023-10-26 17:13:40,678] [INFO] [config.py:972:print]   curriculum_params_legacy ..... False
[2023-10-26 17:13:40,678] [INFO] [config.py:972:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2023-10-26 17:13:40,678] [INFO] [config.py:972:print]   data_efficiency_enabled ...... False
[2023-10-26 17:13:40,678] [INFO] [config.py:972:print]   dataloader_drop_last ......... False
[2023-10-26 17:13:40,678] [INFO] [config.py:972:print]   disable_allgather ............ False
[2023-10-26 17:13:40,678] [INFO] [config.py:972:print]   dump_state ................... False
[2023-10-26 17:13:40,678] [INFO] [config.py:972:print]   dynamic_loss_scale_args ...... None
[2023-10-26 17:13:40,678] [INFO] [config.py:972:print]   eigenvalue_enabled ........... False
[2023-10-26 17:13:40,678] [INFO] [config.py:972:print]   eigenvalue_gas_boundary_resolution  1
[2023-10-26 17:13:40,678] [INFO] [config.py:972:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2023-10-26 17:13:40,678] [INFO] [config.py:972:print]   eigenvalue_layer_num ......... 0
[2023-10-26 17:13:40,679] [INFO] [config.py:972:print]   eigenvalue_max_iter .......... 100
[2023-10-26 17:13:40,679] [INFO] [config.py:972:print]   eigenvalue_stability ......... 1e-06
[2023-10-26 17:13:40,679] [INFO] [config.py:972:print]   eigenvalue_tol ............... 0.01
[2023-10-26 17:13:40,679] [INFO] [config.py:972:print]   eigenvalue_verbose ........... False
[2023-10-26 17:13:40,679] [INFO] [config.py:972:print]   elasticity_enabled ........... False
[2023-10-26 17:13:40,679] [INFO] [config.py:972:print]   flops_profiler_config ........ {
    "enabled": false, 
    "recompute_fwd_factor": 0.0, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2023-10-26 17:13:40,679] [INFO] [config.py:972:print]   fp16_auto_cast ............... None
[2023-10-26 17:13:40,679] [INFO] [config.py:972:print]   fp16_enabled ................. False
[2023-10-26 17:13:40,679] [INFO] [config.py:972:print]   fp16_master_weights_and_gradients  False
[2023-10-26 17:13:40,679] [INFO] [config.py:972:print]   global_rank .................. 0
[2023-10-26 17:13:40,679] [INFO] [config.py:972:print]   grad_accum_dtype ............. None
[2023-10-26 17:13:40,679] [INFO] [config.py:972:print]   gradient_accumulation_steps .. 1
[2023-10-26 17:13:40,680] [INFO] [config.py:972:print]   gradient_clipping ............ 0.0
[2023-10-26 17:13:40,680] [INFO] [config.py:972:print]   gradient_predivide_factor .... 1.0
[2023-10-26 17:13:40,680] [INFO] [config.py:972:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[2023-10-26 17:13:40,680] [INFO] [config.py:972:print]   initial_dynamic_scale ........ 1
[2023-10-26 17:13:40,680] [INFO] [config.py:972:print]   load_universal_checkpoint .... False
[2023-10-26 17:13:40,680] [INFO] [config.py:972:print]   loss_scale ................... 1.0
[2023-10-26 17:13:40,680] [INFO] [config.py:972:print]   memory_breakdown ............. False
[2023-10-26 17:13:40,680] [INFO] [config.py:972:print]   mics_hierarchial_params_gather  False
[2023-10-26 17:13:40,680] [INFO] [config.py:972:print]   mics_shard_size .............. -1
[2023-10-26 17:13:40,680] [INFO] [config.py:972:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') enabled=False
[2023-10-26 17:13:40,681] [INFO] [config.py:972:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2023-10-26 17:13:40,681] [INFO] [config.py:972:print]   optimizer_legacy_fusion ...... False
[2023-10-26 17:13:40,681] [INFO] [config.py:972:print]   optimizer_name ............... adam
[2023-10-26 17:13:40,681] [INFO] [config.py:972:print]   optimizer_params ............. {'lr': 0.0001, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 3e-07}
[2023-10-26 17:13:40,681] [INFO] [config.py:972:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2023-10-26 17:13:40,681] [INFO] [config.py:972:print]   pld_enabled .................. False
[2023-10-26 17:13:40,681] [INFO] [config.py:972:print]   pld_params ................... False
[2023-10-26 17:13:40,681] [INFO] [config.py:972:print]   prescale_gradients ........... False
[2023-10-26 17:13:40,681] [INFO] [config.py:972:print]   scheduler_name ............... WarmupLR
[2023-10-26 17:13:40,681] [INFO] [config.py:972:print]   scheduler_params ............. {'warmup_min_lr': 0, 'warmup_max_lr': 0.0001, 'warmup_num_steps': 1000}
[2023-10-26 17:13:40,681] [INFO] [config.py:972:print]   sparse_attention ............. None
[2023-10-26 17:13:40,681] [INFO] [config.py:972:print]   sparse_gradients_enabled ..... False
[2023-10-26 17:13:40,682] [INFO] [config.py:972:print]   steps_per_print .............. 25
[2023-10-26 17:13:40,682] [INFO] [config.py:972:print]   train_batch_size ............. 128
[2023-10-26 17:13:40,682] [INFO] [config.py:972:print]   train_micro_batch_size_per_gpu  16
[2023-10-26 17:13:40,682] [INFO] [config.py:972:print]   use_node_local_storage ....... False
[2023-10-26 17:13:40,682] [INFO] [config.py:972:print]   wall_clock_breakdown ......... False
[2023-10-26 17:13:40,682] [INFO] [config.py:972:print]   weight_quantization_config ... None
[2023-10-26 17:13:40,682] [INFO] [config.py:972:print]   world_size ................... 8
[2023-10-26 17:13:40,682] [INFO] [config.py:972:print]   zero_allow_untested_optimizer  False
[2023-10-26 17:13:40,682] [INFO] [config.py:972:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_nontrainable_weights=False zero_quantized_gradients=False mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=True pipeline_loading_checkpoint=False override_module_apply=True
[2023-10-26 17:13:40,682] [INFO] [config.py:972:print]   zero_enabled ................. False
[2023-10-26 17:13:40,682] [INFO] [config.py:972:print]   zero_force_ds_cpu_optimizer .. True
[2023-10-26 17:13:40,682] [INFO] [config.py:972:print]   zero_optimization_stage ...... 0
[2023-10-26 17:13:40,683] [INFO] [config.py:958:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 16, 
    "steps_per_print": 25, 
    "bf16": {
        "enabled": true
    }, 
    "optimizer": {
        "type": "Adam", 
        "params": {
            "lr": 0.0001, 
            "betas": [0.9, 0.999], 
            "eps": 1e-08, 
            "weight_decay": 3e-07
        }
    }, 
    "scheduler": {
        "type": "WarmupLR", 
        "params": {
            "warmup_min_lr": 0, 
            "warmup_max_lr": 0.0001, 
            "warmup_num_steps": 1000
        }
    }
}
=========================
Validation loss:  tensor(2.4674, device='cuda:0')
=========================
wandb: Adding directory to artifact (./experiments/Cheatsheet-cifar10-vit_base_patch8_224-CS_SIZE_8-GlobalBatch128-RandomizeSheet/saliency_maps)... Done. 0.0s
[tensor(1), tensor(8), tensor(2), tensor(2), tensor(7), tensor(1), tensor(6), tensor(3), tensor(1), tensor(2), tensor(8), tensor(0), tensor(4), tensor(3), tensor(8), tensor(2), tensor(7), tensor(9), tensor(2), tensor(4), tensor(2), tensor(5), tensor(4), tensor(9), tensor(2), tensor(1), tensor(8), tensor(9), tensor(9), tensor(3), tensor(3), tensor(1), tensor(3), tensor(0), tensor(5), tensor(0), tensor(0), tensor(7), tensor(8), tensor(2), tensor(3), tensor(2), tensor(0), tensor(7), tensor(7), tensor(4), tensor(2), tensor(6), tensor(3), tensor(2), tensor(6), tensor(0), tensor(8), tensor(8), tensor(4), tensor(8), tensor(0), tensor(6), tensor(6), tensor(5), tensor(0), tensor(0), tensor(3), tensor(8), tensor(4), tensor(9), tensor(9), tensor(1), tensor(2), tensor(6), tensor(5), tensor(1), tensor(6), tensor(7), tensor(6), tensor(4), tensor(8), tensor(9), tensor(5), tensor(1), tensor(8), tensor(8), tensor(3), tensor(1), tensor(2), tensor(7), tensor(8), tensor(6), tensor(3), tensor(6), tensor(5), tensor(3), tensor(9), tensor(1), tensor(0), tensor(5), tensor(2), tensor(4), tensor(3), tensor(7), tensor(0), tensor(8), tensor(0), tensor(8), tensor(3), tensor(0), tensor(2), tensor(0), tensor(8), tensor(2), tensor(0), tensor(8), tensor(4), tensor(5), tensor(2), tensor(4), tensor(2), tensor(1), tensor(8), tensor(6), tensor(9), tensor(9), tensor(4), tensor(4), tensor(1), tensor(1), tensor(4), tensor(1)]
Accuracy of plane : 92 %
Accuracy of   car :  0 %
Accuracy of  bird :  5 %
Accuracy of   cat :  0 %
Accuracy of  deer :  0 %
Accuracy of   dog :  0 %
Accuracy of  frog :  0 %
Accuracy of horse :  0 %
Accuracy of  ship :  0 %
Accuracy of truck :  0 %
Total accuracy:  9.53%
Generating new experiment file
[2023-10-26 17:13:49,067] [INFO] [logging.py:96:log_dist] [Rank 0] step=25, skipped=0, lr=[4.659800028906792e-05], mom=[[0.9, 0.999]]
[2023-10-26 17:13:49,069] [INFO] [timer.py:260:stop] epoch=0/micro_step=25/global_step=25, RunningAvgSamplesPerSec=1804.9512923100176, CurrSamplesPerSec=1792.2640769957502, MemAllocated=0.79GB, MaxMemAllocated=4.76GB
[2023-10-26 17:13:50,858] [INFO] [logging.py:96:log_dist] [Rank 0] [Torch] Checkpoint 0 is about to be saved!
/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py:1799: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py:1799: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py:1799: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py:1799: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
[2023-10-26 17:13:50,865] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: experiments/Cheatsheet-cifar10-vit_base_patch8_224-CS_SIZE_8-GlobalBatch128-RandomizeSheet/checkpoints/0/mp_rank_00_model_states.pt
[2023-10-26 17:13:50,866] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving experiments/Cheatsheet-cifar10-vit_base_patch8_224-CS_SIZE_8-GlobalBatch128-RandomizeSheet/checkpoints/0/mp_rank_00_model_states.pt...
/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py:1799: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py:1799: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py:1799: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py:1799: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
[2023-10-26 17:13:51,065] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved experiments/Cheatsheet-cifar10-vit_base_patch8_224-CS_SIZE_8-GlobalBatch128-RandomizeSheet/checkpoints/0/mp_rank_00_model_states.pt.
[2023-10-26 17:13:51,068] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving experiments/Cheatsheet-cifar10-vit_base_patch8_224-CS_SIZE_8-GlobalBatch128-RandomizeSheet/checkpoints/0/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2023-10-26 17:13:51,068] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving experiments/Cheatsheet-cifar10-vit_base_patch8_224-CS_SIZE_8-GlobalBatch128-RandomizeSheet/checkpoints/0/bf16_zero_pp_rank_1_mp_rank_00_optim_states.pt...
[2023-10-26 17:13:51,068] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving experiments/Cheatsheet-cifar10-vit_base_patch8_224-CS_SIZE_8-GlobalBatch128-RandomizeSheet/checkpoints/0/bf16_zero_pp_rank_6_mp_rank_00_optim_states.pt...
[2023-10-26 17:13:51,068] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving experiments/Cheatsheet-cifar10-vit_base_patch8_224-CS_SIZE_8-GlobalBatch128-RandomizeSheet/checkpoints/0/bf16_zero_pp_rank_5_mp_rank_00_optim_states.pt...
[2023-10-26 17:13:51,068] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving experiments/Cheatsheet-cifar10-vit_base_patch8_224-CS_SIZE_8-GlobalBatch128-RandomizeSheet/checkpoints/0/bf16_zero_pp_rank_7_mp_rank_00_optim_states.pt...
[2023-10-26 17:13:51,068] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving experiments/Cheatsheet-cifar10-vit_base_patch8_224-CS_SIZE_8-GlobalBatch128-RandomizeSheet/checkpoints/0/bf16_zero_pp_rank_4_mp_rank_00_optim_states.pt...
[2023-10-26 17:13:51,068] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving experiments/Cheatsheet-cifar10-vit_base_patch8_224-CS_SIZE_8-GlobalBatch128-RandomizeSheet/checkpoints/0/bf16_zero_pp_rank_3_mp_rank_00_optim_states.pt...
[2023-10-26 17:13:51,068] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving experiments/Cheatsheet-cifar10-vit_base_patch8_224-CS_SIZE_8-GlobalBatch128-RandomizeSheet/checkpoints/0/bf16_zero_pp_rank_2_mp_rank_00_optim_states.pt...
[2023-10-26 17:13:51,247] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved experiments/Cheatsheet-cifar10-vit_base_patch8_224-CS_SIZE_8-GlobalBatch128-RandomizeSheet/checkpoints/0/bf16_zero_pp_rank_4_mp_rank_00_optim_states.pt.
[2023-10-26 17:13:51,247] [INFO] [engine.py:3381:_save_zero_checkpoint] bf16_zero checkpoint saved experiments/Cheatsheet-cifar10-vit_base_patch8_224-CS_SIZE_8-GlobalBatch128-RandomizeSheet/checkpoints/0/bf16_zero_pp_rank_4_mp_rank_00_optim_states.pt
[2023-10-26 17:13:51,247] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint 0 is ready now!
[2023-10-26 17:13:51,255] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved experiments/Cheatsheet-cifar10-vit_base_patch8_224-CS_SIZE_8-GlobalBatch128-RandomizeSheet/checkpoints/0/bf16_zero_pp_rank_3_mp_rank_00_optim_states.pt.
[2023-10-26 17:13:51,255] [INFO] [engine.py:3381:_save_zero_checkpoint] bf16_zero checkpoint saved experiments/Cheatsheet-cifar10-vit_base_patch8_224-CS_SIZE_8-GlobalBatch128-RandomizeSheet/checkpoints/0/bf16_zero_pp_rank_3_mp_rank_00_optim_states.pt
[2023-10-26 17:13:51,255] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint 0 is ready now!
[2023-10-26 17:13:51,257] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved experiments/Cheatsheet-cifar10-vit_base_patch8_224-CS_SIZE_8-GlobalBatch128-RandomizeSheet/checkpoints/0/bf16_zero_pp_rank_5_mp_rank_00_optim_states.pt.
[2023-10-26 17:13:51,258] [INFO] [engine.py:3381:_save_zero_checkpoint] bf16_zero checkpoint saved experiments/Cheatsheet-cifar10-vit_base_patch8_224-CS_SIZE_8-GlobalBatch128-RandomizeSheet/checkpoints/0/bf16_zero_pp_rank_5_mp_rank_00_optim_states.pt
[2023-10-26 17:13:51,258] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint 0 is ready now!
[2023-10-26 17:13:51,280] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved experiments/Cheatsheet-cifar10-vit_base_patch8_224-CS_SIZE_8-GlobalBatch128-RandomizeSheet/checkpoints/0/bf16_zero_pp_rank_2_mp_rank_00_optim_states.pt.
[2023-10-26 17:13:51,280] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved experiments/Cheatsheet-cifar10-vit_base_patch8_224-CS_SIZE_8-GlobalBatch128-RandomizeSheet/checkpoints/0/bf16_zero_pp_rank_7_mp_rank_00_optim_states.pt.
[2023-10-26 17:13:51,280] [INFO] [engine.py:3381:_save_zero_checkpoint] bf16_zero checkpoint saved experiments/Cheatsheet-cifar10-vit_base_patch8_224-CS_SIZE_8-GlobalBatch128-RandomizeSheet/checkpoints/0/bf16_zero_pp_rank_2_mp_rank_00_optim_states.pt
[2023-10-26 17:13:51,280] [INFO] [engine.py:3381:_save_zero_checkpoint] bf16_zero checkpoint saved experiments/Cheatsheet-cifar10-vit_base_patch8_224-CS_SIZE_8-GlobalBatch128-RandomizeSheet/checkpoints/0/bf16_zero_pp_rank_7_mp_rank_00_optim_states.pt
[2023-10-26 17:13:51,280] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint 0 is ready now!
[2023-10-26 17:13:51,280] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint 0 is ready now!
[2023-10-26 17:13:51,285] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved experiments/Cheatsheet-cifar10-vit_base_patch8_224-CS_SIZE_8-GlobalBatch128-RandomizeSheet/checkpoints/0/bf16_zero_pp_rank_6_mp_rank_00_optim_states.pt.
[2023-10-26 17:13:51,285] [INFO] [engine.py:3381:_save_zero_checkpoint] bf16_zero checkpoint saved experiments/Cheatsheet-cifar10-vit_base_patch8_224-CS_SIZE_8-GlobalBatch128-RandomizeSheet/checkpoints/0/bf16_zero_pp_rank_6_mp_rank_00_optim_states.pt
[2023-10-26 17:13:51,285] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint 0 is ready now!
[2023-10-26 17:13:51,297] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved experiments/Cheatsheet-cifar10-vit_base_patch8_224-CS_SIZE_8-GlobalBatch128-RandomizeSheet/checkpoints/0/bf16_zero_pp_rank_1_mp_rank_00_optim_states.pt.
[2023-10-26 17:13:51,297] [INFO] [engine.py:3381:_save_zero_checkpoint] bf16_zero checkpoint saved experiments/Cheatsheet-cifar10-vit_base_patch8_224-CS_SIZE_8-GlobalBatch128-RandomizeSheet/checkpoints/0/bf16_zero_pp_rank_1_mp_rank_00_optim_states.pt
[2023-10-26 17:13:51,297] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint 0 is ready now!
[2023-10-26 17:13:51,297] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved experiments/Cheatsheet-cifar10-vit_base_patch8_224-CS_SIZE_8-GlobalBatch128-RandomizeSheet/checkpoints/0/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2023-10-26 17:13:51,298] [INFO] [engine.py:3381:_save_zero_checkpoint] bf16_zero checkpoint saved experiments/Cheatsheet-cifar10-vit_base_patch8_224-CS_SIZE_8-GlobalBatch128-RandomizeSheet/checkpoints/0/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt
[2023-10-26 17:13:51,299] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint 0 is ready now!
=========================
Validation loss:  tensor(2.3021, device='cuda:0')
=========================
wandb: Adding directory to artifact (./experiments/Cheatsheet-cifar10-vit_base_patch8_224-CS_SIZE_8-GlobalBatch128-RandomizeSheet/saliency_maps)... Done. 0.0s
[tensor(0), tensor(6), tensor(1), tensor(8), tensor(0), tensor(8), tensor(1), tensor(0), tensor(9), tensor(1), tensor(5), tensor(7), tensor(6), tensor(8), tensor(5), tensor(1), tensor(2), tensor(9), tensor(9), tensor(8), tensor(9), tensor(8), tensor(3), tensor(1), tensor(6), tensor(6), tensor(9), tensor(1), tensor(1), tensor(3), tensor(1), tensor(9), tensor(5), tensor(6), tensor(1), tensor(2), tensor(8), tensor(7), tensor(1), tensor(9), tensor(0), tensor(8), tensor(2), tensor(9), tensor(6), tensor(8), tensor(0), tensor(0), tensor(4), tensor(0), tensor(0), tensor(6), tensor(8), tensor(8), tensor(6), tensor(2), tensor(6), tensor(6), tensor(7), tensor(4), tensor(9), tensor(2), tensor(5), tensor(7), tensor(9), tensor(9), tensor(8), tensor(5), tensor(7), tensor(3), tensor(3), tensor(9), tensor(3), tensor(7), tensor(5), tensor(4), tensor(1), tensor(9), tensor(7), tensor(8), tensor(0), tensor(8), tensor(5), tensor(7), tensor(9), tensor(8), tensor(9), tensor(4), tensor(4), tensor(1), tensor(7), tensor(0), tensor(5), tensor(4), tensor(8), tensor(2), tensor(7), tensor(4), tensor(8), tensor(4), tensor(1), tensor(5), tensor(5), tensor(9), tensor(9), tensor(7), tensor(4), tensor(5), tensor(4), tensor(3), tensor(5), tensor(3), tensor(2), tensor(5), tensor(4), tensor(8), tensor(8), tensor(5), tensor(3), tensor(0), tensor(8), tensor(7), tensor(8), tensor(6), tensor(4), tensor(9), tensor(0), tensor(7)]
Accuracy of plane :  0 %
Accuracy of   car :  0 %
Accuracy of  bird :  0 %
Accuracy of   cat :  0 %
Accuracy of  deer :  0 %
Accuracy of   dog :  0 %
Accuracy of  frog : 100 %
Accuracy of horse :  0 %
Accuracy of  ship :  0 %
Accuracy of truck :  0 %
Total accuracy:  9.63%
[2023-10-26 17:13:56,950] [INFO] [logging.py:96:log_dist] [Rank 0] step=50, skipped=0, lr=[5.663233347786729e-05], mom=[[0.9, 0.999]]
[2023-10-26 17:13:56,952] [INFO] [timer.py:260:stop] epoch=0/micro_step=50/global_step=50, RunningAvgSamplesPerSec=1798.7372709576475, CurrSamplesPerSec=1779.173403412725, MemAllocated=0.79GB, MaxMemAllocated=4.9GB
[2023-10-26 17:13:58,844] [INFO] [logging.py:96:log_dist] [Rank 0] step=75, skipped=0, lr=[6.250204211305667e-05], mom=[[0.9, 0.999]]
[2023-10-26 17:13:58,846] [INFO] [timer.py:260:stop] epoch=0/micro_step=75/global_step=75, RunningAvgSamplesPerSec=1799.7645923626003, CurrSamplesPerSec=1806.6181600368814, MemAllocated=0.79GB, MaxMemAllocated=4.9GB
=========================
Validation loss:  tensor(0.0068, device='cuda:0')
=========================
wandb: Adding directory to artifact (./experiments/Cheatsheet-cifar10-vit_base_patch8_224-CS_SIZE_8-GlobalBatch128-RandomizeSheet/saliency_maps)... Done. 0.0s
[tensor(6), tensor(0), tensor(1), tensor(1), tensor(2), tensor(4), tensor(5), tensor(8), tensor(5), tensor(4), tensor(3), tensor(6), tensor(8), tensor(6), tensor(7), tensor(2), tensor(6), tensor(6), tensor(8), tensor(1), tensor(3), tensor(0), tensor(9), tensor(7), tensor(4), tensor(9), tensor(2), tensor(1), tensor(4), tensor(0), tensor(1), tensor(7), tensor(0), tensor(5), tensor(3), tensor(0), tensor(6), tensor(4), tensor(8), tensor(9), tensor(0), tensor(2), tensor(8), tensor(7), tensor(7), tensor(2), tensor(5), tensor(0), tensor(6), tensor(2), tensor(9), tensor(2), tensor(4), tensor(1), tensor(5), tensor(9), tensor(2), tensor(4), tensor(5), tensor(2), tensor(3), tensor(6), tensor(1), tensor(2), tensor(3), tensor(4), tensor(0), tensor(1), tensor(9), tensor(4), tensor(4), tensor(9), tensor(6), tensor(8), tensor(2), tensor(3), tensor(1), tensor(0), tensor(2), tensor(0), tensor(4), tensor(7), tensor(3), tensor(4), tensor(0), tensor(9), tensor(5), tensor(8), tensor(6), tensor(9), tensor(7), tensor(4), tensor(6), tensor(0), tensor(0), tensor(2), tensor(1), tensor(8), tensor(6), tensor(9), tensor(3), tensor(3), tensor(5), tensor(0), tensor(0), tensor(7), tensor(1), tensor(3), tensor(9), tensor(4), tensor(5), tensor(0), tensor(2), tensor(0), tensor(7), tensor(2), tensor(6), tensor(9), tensor(3), tensor(9), tensor(5), tensor(7), tensor(2), tensor(1), tensor(6), tensor(9), tensor(8), tensor(1)]
Accuracy of plane : 100 %
Accuracy of   car : 100 %
Accuracy of  bird : 100 %
Accuracy of   cat : 100 %
Accuracy of  deer : 100 %
Accuracy of   dog : 100 %
Accuracy of  frog : 100 %
Accuracy of horse : 100 %
Accuracy of  ship : 100 %
Accuracy of truck : 100 %
Total accuracy:  100.0%
[2023-10-26 17:14:06,468] [INFO] [logging.py:96:log_dist] [Rank 0] step=100, skipped=0, lr=[6.666666666666668e-05], mom=[[0.9, 0.999]]
[2023-10-26 17:14:06,470] [INFO] [timer.py:260:stop] epoch=0/micro_step=100/global_step=100, RunningAvgSamplesPerSec=1782.3503390552364, CurrSamplesPerSec=1759.4537237616137, MemAllocated=0.8GB, MaxMemAllocated=4.91GB
[2023-10-26 17:14:08,362] [INFO] [logging.py:96:log_dist] [Rank 0] step=125, skipped=0, lr=[6.989700043360188e-05], mom=[[0.9, 0.999]]
[2023-10-26 17:14:08,364] [INFO] [timer.py:260:stop] epoch=0/micro_step=125/global_step=125, RunningAvgSamplesPerSec=1783.8323892739452, CurrSamplesPerSec=1784.6737516745727, MemAllocated=0.8GB, MaxMemAllocated=4.91GB
=========================
Validation loss:  tensor(4.9849e-05, device='cuda:0')
=========================
wandb: Adding directory to artifact (./experiments/Cheatsheet-cifar10-vit_base_patch8_224-CS_SIZE_8-GlobalBatch128-RandomizeSheet/saliency_maps)... Done. 0.0s
[tensor(5), tensor(0), tensor(3), tensor(5), tensor(0), tensor(9), tensor(0), tensor(8), tensor(0), tensor(1), tensor(9), tensor(2), tensor(6), tensor(9), tensor(8), tensor(4), tensor(8), tensor(5), tensor(9), tensor(1), tensor(6), tensor(6), tensor(2), tensor(3), tensor(0), tensor(0), tensor(4), tensor(9), tensor(9), tensor(8), tensor(0), tensor(1), tensor(8), tensor(1), tensor(4), tensor(5), tensor(8), tensor(9), tensor(2), tensor(2), tensor(0), tensor(1), tensor(5), tensor(9), tensor(2), tensor(6), tensor(4), tensor(1), tensor(0), tensor(0), tensor(1), tensor(3), tensor(0), tensor(3), tensor(4), tensor(8), tensor(1), tensor(7), tensor(5), tensor(7), tensor(4), tensor(0), tensor(4), tensor(4), tensor(5), tensor(2), tensor(5), tensor(7), tensor(3), tensor(5), tensor(8), tensor(0), tensor(7), tensor(1), tensor(3), tensor(4), tensor(4), tensor(6), tensor(1), tensor(1), tensor(3), tensor(1), tensor(0), tensor(4), tensor(9), tensor(0), tensor(6), tensor(5), tensor(2), tensor(1), tensor(0), tensor(9), tensor(2), tensor(2), tensor(4), tensor(7), tensor(4), tensor(8), tensor(1), tensor(3), tensor(6), tensor(1), tensor(9), tensor(9), tensor(2), tensor(2), tensor(6), tensor(2), tensor(6), tensor(3), tensor(8), tensor(1), tensor(0), tensor(1), tensor(8), tensor(3), tensor(6), tensor(6), tensor(8), tensor(2), tensor(6), tensor(4), tensor(6), tensor(9), tensor(0), tensor(5), tensor(3), tensor(0)]
Accuracy of plane : 100 %
Accuracy of   car : 100 %
Accuracy of  bird : 100 %
Accuracy of   cat : 100 %
Accuracy of  deer : 100 %
Accuracy of   dog : 100 %
Accuracy of  frog : 100 %
Accuracy of horse : 100 %
Accuracy of  ship : 100 %
Accuracy of truck : 100 %
Total accuracy:  100.0%
[2023-10-26 17:14:15,902] [INFO] [logging.py:96:log_dist] [Rank 0] step=150, skipped=0, lr=[7.253637530185604e-05], mom=[[0.9, 0.999]]
[2023-10-26 17:14:15,905] [INFO] [timer.py:260:stop] epoch=0/micro_step=150/global_step=150, RunningAvgSamplesPerSec=1785.693826042578, CurrSamplesPerSec=1773.818201041419, MemAllocated=0.8GB, MaxMemAllocated=4.91GB
[2023-10-26 17:14:17,794] [INFO] [logging.py:96:log_dist] [Rank 0] step=175, skipped=0, lr=[7.476793495620984e-05], mom=[[0.9, 0.999]]
[2023-10-26 17:14:17,796] [INFO] [timer.py:260:stop] epoch=0/micro_step=175/global_step=175, RunningAvgSamplesPerSec=1786.9964661868887, CurrSamplesPerSec=1814.531613225945, MemAllocated=0.8GB, MaxMemAllocated=4.91GB
=========================
Validation loss:  tensor(2.2848e-05, device='cuda:0')
=========================
wandb: Adding directory to artifact (./experiments/Cheatsheet-cifar10-vit_base_patch8_224-CS_SIZE_8-GlobalBatch128-RandomizeSheet/saliency_maps)... Done. 0.0s
[tensor(4), tensor(2), tensor(5), tensor(4), tensor(2), tensor(8), tensor(9), tensor(7), tensor(2), tensor(7), tensor(3), tensor(2), tensor(6), tensor(1), tensor(4), tensor(3), tensor(0), tensor(9), tensor(8), tensor(4), tensor(3), tensor(7), tensor(1), tensor(8), tensor(8), tensor(1), tensor(2), tensor(2), tensor(9), tensor(1), tensor(2), tensor(1), tensor(4), tensor(1), tensor(1), tensor(7), tensor(9), tensor(7), tensor(6), tensor(8), tensor(1), tensor(2), tensor(1), tensor(8), tensor(1), tensor(0), tensor(9), tensor(3), tensor(6), tensor(5), tensor(1), tensor(0), tensor(3), tensor(9), tensor(5), tensor(6), tensor(0), tensor(9), tensor(7), tensor(5), tensor(8), tensor(6), tensor(5), tensor(2), tensor(2), tensor(8), tensor(8), tensor(6), tensor(9), tensor(3), tensor(1), tensor(0), tensor(4), tensor(0), tensor(3), tensor(2), tensor(5), tensor(2), tensor(5), tensor(6), tensor(5), tensor(7), tensor(0), tensor(3), tensor(9), tensor(8), tensor(0), tensor(8), tensor(2), tensor(6), tensor(7), tensor(6), tensor(3), tensor(0), tensor(3), tensor(7), tensor(3), tensor(1), tensor(3), tensor(6), tensor(9), tensor(2), tensor(4), tensor(4), tensor(0), tensor(6), tensor(2), tensor(2), tensor(7), tensor(5), tensor(8), tensor(7), tensor(0), tensor(3), tensor(7), tensor(1), tensor(0), tensor(3), tensor(1), tensor(8), tensor(4), tensor(4), tensor(1), tensor(9), tensor(1), tensor(6), tensor(3), tensor(1)]
Accuracy of plane : 100 %
Accuracy of   car : 100 %
Accuracy of  bird : 100 %
Accuracy of   cat : 100 %
Accuracy of  deer : 100 %
Accuracy of   dog : 100 %
Accuracy of  frog : 100 %
Accuracy of horse : 100 %
Accuracy of  ship : 100 %
Accuracy of truck : 100 %
Total accuracy:  100.0%
[2023-10-26 17:14:25,415] [INFO] [logging.py:96:log_dist] [Rank 0] step=200, skipped=0, lr=[7.670099985546603e-05], mom=[[0.9, 0.999]]
[2023-10-26 17:14:25,417] [INFO] [timer.py:260:stop] epoch=0/micro_step=200/global_step=200, RunningAvgSamplesPerSec=1768.5353015735323, CurrSamplesPerSec=1820.7840139457433, MemAllocated=0.8GB, MaxMemAllocated=4.92GB
[2023-10-26 17:14:27,295] [INFO] [logging.py:96:log_dist] [Rank 0] step=225, skipped=0, lr=[7.840608393704543e-05], mom=[[0.9, 0.999]]
[2023-10-26 17:14:27,297] [INFO] [timer.py:260:stop] epoch=0/micro_step=225/global_step=225, RunningAvgSamplesPerSec=1771.7015011636972, CurrSamplesPerSec=1804.6020416738095, MemAllocated=0.8GB, MaxMemAllocated=4.92GB
=========================
Validation loss:  tensor(1.4752e-05, device='cuda:0')
=========================
wandb: Adding directory to artifact (./experiments/Cheatsheet-cifar10-vit_base_patch8_224-CS_SIZE_8-GlobalBatch128-RandomizeSheet/saliency_maps)... Done. 0.1s
[tensor(9), tensor(6), tensor(2), tensor(6), tensor(2), tensor(3), tensor(9), tensor(1), tensor(0), tensor(1), tensor(1), tensor(6), tensor(6), tensor(1), tensor(4), tensor(8), tensor(4), tensor(9), tensor(3), tensor(8), tensor(9), tensor(0), tensor(9), tensor(9), tensor(8), tensor(6), tensor(3), tensor(1), tensor(7), tensor(1), tensor(3), tensor(9), tensor(9), tensor(3), tensor(0), tensor(8), tensor(7), tensor(9), tensor(9), tensor(2), tensor(0), tensor(8), tensor(3), tensor(6), tensor(8), tensor(7), tensor(1), tensor(1), tensor(2), tensor(4), tensor(1), tensor(2), tensor(0), tensor(4), tensor(0), tensor(0), tensor(1), tensor(4), tensor(9), tensor(3), tensor(3), tensor(6), tensor(7), tensor(5), tensor(0), tensor(8), tensor(0), tensor(9), tensor(8), tensor(1), tensor(3), tensor(0), tensor(7), tensor(2), tensor(1), tensor(7), tensor(4), tensor(3), tensor(7), tensor(3), tensor(5), tensor(7), tensor(2), tensor(4), tensor(1), tensor(9), tensor(2), tensor(3), tensor(6), tensor(0), tensor(6), tensor(3), tensor(4), tensor(3), tensor(9), tensor(7), tensor(3), tensor(3), tensor(8), tensor(1), tensor(1), tensor(4), tensor(2), tensor(8), tensor(6), tensor(5), tensor(9), tensor(4), tensor(9), tensor(7), tensor(2), tensor(0), tensor(5), tensor(1), tensor(4), tensor(9), tensor(6), tensor(4), tensor(4), tensor(8), tensor(9), tensor(9), tensor(0), tensor(0), tensor(1), tensor(5), tensor(3), tensor(2)]
Accuracy of plane : 100 %
Accuracy of   car : 100 %
Accuracy of  bird : 100 %
Accuracy of   cat : 100 %
Accuracy of  deer : 100 %
Accuracy of   dog : 100 %
Accuracy of  frog : 100 %
Accuracy of horse : 100 %
Accuracy of  ship : 100 %
Accuracy of truck : 100 %
Total accuracy:  100.0%
[2023-10-26 17:14:35,109] [INFO] [logging.py:96:log_dist] [Rank 0] step=250, skipped=0, lr=[7.993133362240125e-05], mom=[[0.9, 0.999]]
[2023-10-26 17:14:35,111] [INFO] [timer.py:260:stop] epoch=0/micro_step=250/global_step=250, RunningAvgSamplesPerSec=1767.0245163661732, CurrSamplesPerSec=1768.710711673662, MemAllocated=0.81GB, MaxMemAllocated=4.93GB
[2023-10-26 17:14:37,001] [INFO] [logging.py:96:log_dist] [Rank 0] step=275, skipped=0, lr=[8.13110897943421e-05], mom=[[0.9, 0.999]]
[2023-10-26 17:14:37,003] [INFO] [timer.py:260:stop] epoch=0/micro_step=275/global_step=275, RunningAvgSamplesPerSec=1769.6099754172003, CurrSamplesPerSec=1788.1570625872228, MemAllocated=0.81GB, MaxMemAllocated=4.93GB
=========================
Validation loss:  tensor(1.0222e-05, device='cuda:0')
=========================
wandb: Adding directory to artifact (./experiments/Cheatsheet-cifar10-vit_base_patch8_224-CS_SIZE_8-GlobalBatch128-RandomizeSheet/saliency_maps)... Done. 0.1s
[tensor(6), tensor(5), tensor(1), tensor(3), tensor(2), tensor(6), tensor(6), tensor(9), tensor(2), tensor(0), tensor(8), tensor(1), tensor(6), tensor(9), tensor(5), tensor(5), tensor(3), tensor(8), tensor(0), tensor(4), tensor(0), tensor(6), tensor(2), tensor(8), tensor(4), tensor(6), tensor(8), tensor(5), tensor(0), tensor(9), tensor(3), tensor(1), tensor(8), tensor(2), tensor(6), tensor(4), tensor(7), tensor(1), tensor(5), tensor(1), tensor(1), tensor(0), tensor(0), tensor(9), tensor(3), tensor(2), tensor(1), tensor(2), tensor(9), tensor(9), tensor(7), tensor(9), tensor(0), tensor(1), tensor(9), tensor(7), tensor(0), tensor(3), tensor(1), tensor(5), tensor(7), tensor(9), tensor(9), tensor(0), tensor(8), tensor(2), tensor(5), tensor(8), tensor(5), tensor(8), tensor(3), tensor(6), tensor(3), tensor(0), tensor(0), tensor(8), tensor(6), tensor(8), tensor(1), tensor(6), tensor(2), tensor(9), tensor(0), tensor(6), tensor(2), tensor(5), tensor(1), tensor(2), tensor(9), tensor(6), tensor(4), tensor(3), tensor(4), tensor(8), tensor(9), tensor(2), tensor(1), tensor(2), tensor(1), tensor(4), tensor(8), tensor(1), tensor(4), tensor(9), tensor(5), tensor(9), tensor(8), tensor(6), tensor(0), tensor(1), tensor(6), tensor(2), tensor(2), tensor(9), tensor(8), tensor(3), tensor(0), tensor(0), tensor(2), tensor(9), tensor(8), tensor(3), tensor(1), tensor(3), tensor(6), tensor(1), tensor(4), tensor(0)]
Accuracy of plane : 100 %
Accuracy of   car : 100 %
Accuracy of  bird : 100 %
Accuracy of   cat : 100 %
Accuracy of  deer : 100 %
Accuracy of   dog : 100 %
Accuracy of  frog : 100 %
Accuracy of horse : 100 %
Accuracy of  ship : 100 %
Accuracy of truck : 100 %
Total accuracy:  100.0%
[2023-10-26 17:14:44,683] [INFO] [logging.py:96:log_dist] [Rank 0] step=300, skipped=0, lr=[8.257070849065543e-05], mom=[[0.9, 0.999]]
[2023-10-26 17:14:44,685] [INFO] [timer.py:260:stop] epoch=0/micro_step=300/global_step=300, RunningAvgSamplesPerSec=1770.773833750516, CurrSamplesPerSec=1795.1046125553792, MemAllocated=0.82GB, MaxMemAllocated=4.93GB
[2023-10-26 17:14:46,585] [INFO] [logging.py:96:log_dist] [Rank 0] step=325, skipped=0, lr=[8.372944536596249e-05], mom=[[0.9, 0.999]]
[2023-10-26 17:14:46,587] [INFO] [timer.py:260:stop] epoch=0/micro_step=325/global_step=325, RunningAvgSamplesPerSec=1772.8138531650739, CurrSamplesPerSec=1798.9241120493232, MemAllocated=0.82GB, MaxMemAllocated=4.93GB
=========================
Validation loss:  tensor(7.6021e-06, device='cuda:0')
=========================
wandb: Adding directory to artifact (./experiments/Cheatsheet-cifar10-vit_base_patch8_224-CS_SIZE_8-GlobalBatch128-RandomizeSheet/saliency_maps)... Done. 0.1s
[tensor(9), tensor(0), tensor(0), tensor(2), tensor(8), tensor(8), tensor(8), tensor(5), tensor(4), tensor(5), tensor(3), tensor(2), tensor(6), tensor(8), tensor(1), tensor(8), tensor(2), tensor(6), tensor(9), tensor(4), tensor(5), tensor(6), tensor(3), tensor(2), tensor(8), tensor(3), tensor(4), tensor(8), tensor(6), tensor(8), tensor(4), tensor(2), tensor(6), tensor(9), tensor(7), tensor(5), tensor(8), tensor(2), tensor(3), tensor(6), tensor(6), tensor(9), tensor(3), tensor(4), tensor(1), tensor(1), tensor(2), tensor(1), tensor(9), tensor(0), tensor(2), tensor(5), tensor(4), tensor(9), tensor(0), tensor(2), tensor(7), tensor(8), tensor(6), tensor(3), tensor(3), tensor(3), tensor(9), tensor(6), tensor(0), tensor(3), tensor(4), tensor(9), tensor(1), tensor(3), tensor(0), tensor(7), tensor(7), tensor(0), tensor(7), tensor(7), tensor(8), tensor(0), tensor(2), tensor(1), tensor(2), tensor(7), tensor(1), tensor(6), tensor(4), tensor(2), tensor(5), tensor(6), tensor(8), tensor(3), tensor(1), tensor(9), tensor(5), tensor(5), tensor(5), tensor(9), tensor(5), tensor(2), tensor(6), tensor(0), tensor(2), tensor(8), tensor(3), tensor(0), tensor(4), tensor(7), tensor(3), tensor(2), tensor(4), tensor(4), tensor(6), tensor(9), tensor(1), tensor(2), tensor(3), tensor(9), tensor(5), tensor(8), tensor(0), tensor(0), tensor(5), tensor(5), tensor(0), tensor(4), tensor(1), tensor(3), tensor(8), tensor(6)]
Accuracy of plane : 100 %
Accuracy of   car : 100 %
Accuracy of  bird : 100 %
Accuracy of   cat : 100 %
Accuracy of  deer : 100 %
Accuracy of   dog : 100 %
Accuracy of  frog : 100 %
Accuracy of horse : 100 %
Accuracy of  ship : 100 %
Accuracy of truck : 100 %
Total accuracy:  100.0%
[2023-10-26 17:14:54,297] [INFO] [logging.py:96:log_dist] [Rank 0] step=350, skipped=0, lr=[8.480226814500919e-05], mom=[[0.9, 0.999]]
[2023-10-26 17:14:54,299] [INFO] [timer.py:260:stop] epoch=0/micro_step=350/global_step=350, RunningAvgSamplesPerSec=1766.6632257388083, CurrSamplesPerSec=1822.2301449649212, MemAllocated=0.82GB, MaxMemAllocated=4.93GB
[2023-10-26 17:14:56,194] [INFO] [logging.py:96:log_dist] [Rank 0] step=375, skipped=0, lr=[8.580104225759063e-05], mom=[[0.9, 0.999]]
[2023-10-26 17:14:56,196] [INFO] [timer.py:260:stop] epoch=0/micro_step=375/global_step=375, RunningAvgSamplesPerSec=1767.7541200509627, CurrSamplesPerSec=1790.136583251363, MemAllocated=0.82GB, MaxMemAllocated=4.93GB
=========================
Validation loss:  tensor(5.9033e-06, device='cuda:0')
=========================
wandb: Adding directory to artifact (./experiments/Cheatsheet-cifar10-vit_base_patch8_224-CS_SIZE_8-GlobalBatch128-RandomizeSheet/saliency_maps)... Done. 0.1s
[tensor(8), tensor(6), tensor(7), tensor(9), tensor(1), tensor(0), tensor(4), tensor(2), tensor(4), tensor(6), tensor(1), tensor(8), tensor(1), tensor(8), tensor(7), tensor(3), tensor(9), tensor(6), tensor(8), tensor(9), tensor(9), tensor(9), tensor(5), tensor(3), tensor(4), tensor(5), tensor(1), tensor(1), tensor(9), tensor(9), tensor(1), tensor(5), tensor(2), tensor(6), tensor(7), tensor(5), tensor(9), tensor(8), tensor(8), tensor(4), tensor(8), tensor(9), tensor(8), tensor(0), tensor(4), tensor(2), tensor(1), tensor(8), tensor(8), tensor(5), tensor(8), tensor(4), tensor(8), tensor(9), tensor(6), tensor(2), tensor(8), tensor(3), tensor(3), tensor(4), tensor(7), tensor(8), tensor(5), tensor(7), tensor(7), tensor(2), tensor(3), tensor(6), tensor(9), tensor(2), tensor(0), tensor(7), tensor(8), tensor(1), tensor(6), tensor(5), tensor(8), tensor(1), tensor(8), tensor(8), tensor(1), tensor(5), tensor(7), tensor(4), tensor(8), tensor(8), tensor(5), tensor(5), tensor(6), tensor(3), tensor(1), tensor(5), tensor(2), tensor(5), tensor(9), tensor(5), tensor(1), tensor(3), tensor(2), tensor(5), tensor(0), tensor(4), tensor(6), tensor(1), tensor(5), tensor(9), tensor(5), tensor(8), tensor(7), tensor(1), tensor(4), tensor(7), tensor(6), tensor(1), tensor(1), tensor(9), tensor(3), tensor(3), tensor(0), tensor(4), tensor(5), tensor(9), tensor(6), tensor(1), tensor(5), tensor(6), tensor(1), tensor(5)]
Accuracy of plane : 100 %
Accuracy of   car : 100 %
Accuracy of  bird : 100 %
Accuracy of   cat : 100 %
Accuracy of  deer : 100 %
Accuracy of   dog : 100 %
Accuracy of  frog : 100 %
Accuracy of horse : 100 %
Accuracy of  ship : 100 %
Accuracy of truck : 100 %
Total accuracy:  100.0%
[2023-10-26 17:15:03,869] [INFO] [logging.py:96:log_dist] [Rank 0] step=400, skipped=0, lr=[8.673533304426543e-05], mom=[[0.9, 0.999]]
[2023-10-26 17:15:03,872] [INFO] [timer.py:260:stop] epoch=0/micro_step=400/global_step=400, RunningAvgSamplesPerSec=1766.4695225827336, CurrSamplesPerSec=1757.863704974608, MemAllocated=0.82GB, MaxMemAllocated=4.93GB
[2023-10-26 17:15:05,790] [INFO] [logging.py:96:log_dist] [Rank 0] step=425, skipped=0, lr=[8.761296433501039e-05], mom=[[0.9, 0.999]]
[2023-10-26 17:15:05,792] [INFO] [timer.py:260:stop] epoch=0/micro_step=425/global_step=425, RunningAvgSamplesPerSec=1767.8625005564068, CurrSamplesPerSec=1781.7478336768254, MemAllocated=0.82GB, MaxMemAllocated=4.93GB
=========================
Validation loss:  tensor(4.6963e-06, device='cuda:0')
=========================
wandb: Adding directory to artifact (./experiments/Cheatsheet-cifar10-vit_base_patch8_224-CS_SIZE_8-GlobalBatch128-RandomizeSheet/saliency_maps)... Done. 0.1s
[tensor(0), tensor(2), tensor(7), tensor(9), tensor(0), tensor(9), tensor(5), tensor(9), tensor(2), tensor(7), tensor(5), tensor(5), tensor(3), tensor(5), tensor(2), tensor(6), tensor(3), tensor(8), tensor(6), tensor(3), tensor(5), tensor(0), tensor(5), tensor(9), tensor(2), tensor(4), tensor(3), tensor(4), tensor(1), tensor(8), tensor(2), tensor(4), tensor(0), tensor(8), tensor(6), tensor(7), tensor(2), tensor(4), tensor(6), tensor(8), tensor(6), tensor(0), tensor(8), tensor(4), tensor(8), tensor(7), tensor(5), tensor(9), tensor(7), tensor(4), tensor(5), tensor(4), tensor(9), tensor(3), tensor(5), tensor(7), tensor(9), tensor(8), tensor(1), tensor(5), tensor(6), tensor(2), tensor(9), tensor(9), tensor(8), tensor(6), tensor(6), tensor(1), tensor(3), tensor(4), tensor(6), tensor(0), tensor(2), tensor(0), tensor(4), tensor(7), tensor(3), tensor(6), tensor(2), tensor(0), tensor(9), tensor(2), tensor(1), tensor(1), tensor(1), tensor(0), tensor(7), tensor(0), tensor(3), tensor(6), tensor(3), tensor(2), tensor(2), tensor(6), tensor(2), tensor(6), tensor(2), tensor(5), tensor(7), tensor(6), tensor(2), tensor(6), tensor(5), tensor(1), tensor(8), tensor(8), tensor(7), tensor(8), tensor(9), tensor(8), tensor(6), tensor(7), tensor(2), tensor(9), tensor(7), tensor(5), tensor(8), tensor(9), tensor(7), tensor(6), tensor(3), tensor(9), tensor(3), tensor(7), tensor(6), tensor(3), tensor(1), tensor(1)]
Accuracy of plane : 100 %
Accuracy of   car : 100 %
Accuracy of  bird : 100 %
Accuracy of   cat : 100 %
Accuracy of  deer : 100 %
Accuracy of   dog : 100 %
Accuracy of  frog : 100 %
Accuracy of horse : 100 %
Accuracy of  ship : 100 %
Accuracy of truck : 100 %
Total accuracy:  100.0%
[2023-10-26 17:15:13,462] [INFO] [logging.py:96:log_dist] [Rank 0] step=450, skipped=0, lr=[8.84404171258448e-05], mom=[[0.9, 0.999]]
[2023-10-26 17:15:13,465] [INFO] [timer.py:260:stop] epoch=0/micro_step=450/global_step=450, RunningAvgSamplesPerSec=1770.1261224171349, CurrSamplesPerSec=1831.9862960410028, MemAllocated=0.83GB, MaxMemAllocated=4.94GB
[2023-10-26 17:15:15,368] [INFO] [logging.py:96:log_dist] [Rank 0] step=475, skipped=0, lr=[8.922312032082888e-05], mom=[[0.9, 0.999]]
[2023-10-26 17:15:15,370] [INFO] [timer.py:260:stop] epoch=0/micro_step=475/global_step=475, RunningAvgSamplesPerSec=1771.7377839195804, CurrSamplesPerSec=1790.572427225913, MemAllocated=0.83GB, MaxMemAllocated=4.94GB
=========================
Validation loss:  tensor(3.8308e-06, device='cuda:0')
=========================
wandb: Adding directory to artifact (./experiments/Cheatsheet-cifar10-vit_base_patch8_224-CS_SIZE_8-GlobalBatch128-RandomizeSheet/saliency_maps)... Done. 0.1s
[tensor(9), tensor(5), tensor(5), tensor(8), tensor(7), tensor(6), tensor(7), tensor(6), tensor(6), tensor(3), tensor(8), tensor(5), tensor(4), tensor(5), tensor(9), tensor(9), tensor(0), tensor(7), tensor(7), tensor(0), tensor(6), tensor(8), tensor(7), tensor(5), tensor(5), tensor(9), tensor(2), tensor(1), tensor(9), tensor(0), tensor(7), tensor(0), tensor(8), tensor(1), tensor(0), tensor(6), tensor(0), tensor(8), tensor(4), tensor(3), tensor(8), tensor(4), tensor(3), tensor(7), tensor(4), tensor(0), tensor(3), tensor(1), tensor(4), tensor(3), tensor(0), tensor(8), tensor(7), tensor(6), tensor(2), tensor(2), tensor(2), tensor(3), tensor(6), tensor(0), tensor(7), tensor(9), tensor(0), tensor(9), tensor(1), tensor(5), tensor(8), tensor(5), tensor(5), tensor(5), tensor(7), tensor(8), tensor(2), tensor(6), tensor(0), tensor(8), tensor(1), tensor(3), tensor(7), tensor(9), tensor(7), tensor(1), tensor(4), tensor(2), tensor(3), tensor(5), tensor(9), tensor(8), tensor(1), tensor(8), tensor(2), tensor(3), tensor(0), tensor(6), tensor(3), tensor(1), tensor(3), tensor(3), tensor(4), tensor(1), tensor(1), tensor(4), tensor(0), tensor(7), tensor(3), tensor(0), tensor(4), tensor(4), tensor(0), tensor(2), tensor(0), tensor(5), tensor(9), tensor(0), tensor(9), tensor(7), tensor(3), tensor(7), tensor(1), tensor(8), tensor(4), tensor(1), tensor(9), tensor(2), tensor(4), tensor(6), tensor(2), tensor(6)]
Accuracy of plane : 100 %
Accuracy of   car : 100 %
Accuracy of  bird : 100 %
Accuracy of   cat : 100 %
Accuracy of  deer : 100 %
Accuracy of   dog : 100 %
Accuracy of  frog : 100 %
Accuracy of horse : 100 %
Accuracy of  ship : 100 %
Accuracy of truck : 100 %
Total accuracy:  100.0%
[2023-10-26 17:15:23,023] [INFO] [logging.py:96:log_dist] [Rank 0] step=500, skipped=0, lr=[8.996566681120063e-05], mom=[[0.9, 0.999]]
[2023-10-26 17:15:23,025] [INFO] [timer.py:260:stop] epoch=0/micro_step=500/global_step=500, RunningAvgSamplesPerSec=1769.3134129614557, CurrSamplesPerSec=1795.0505944818178, MemAllocated=0.83GB, MaxMemAllocated=4.94GB
[2023-10-26 17:15:24,916] [INFO] [logging.py:96:log_dist] [Rank 0] step=525, skipped=0, lr=[9.067197678019857e-05], mom=[[0.9, 0.999]]
[2023-10-26 17:15:24,918] [INFO] [timer.py:260:stop] epoch=0/micro_step=525/global_step=525, RunningAvgSamplesPerSec=1769.868409138194, CurrSamplesPerSec=1768.2388519822541, MemAllocated=0.83GB, MaxMemAllocated=4.94GB
[2023-10-26 17:15:25,172] [INFO] [logging.py:96:log_dist] [Rank 0] [Torch] Checkpoint 10 is about to be saved!
[2023-10-26 17:15:25,177] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: experiments/Cheatsheet-cifar10-vit_base_patch8_224-CS_SIZE_8-GlobalBatch128-RandomizeSheet/checkpoints/10/mp_rank_00_model_states.pt
[2023-10-26 17:15:25,177] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving experiments/Cheatsheet-cifar10-vit_base_patch8_224-CS_SIZE_8-GlobalBatch128-RandomizeSheet/checkpoints/10/mp_rank_00_model_states.pt...
[2023-10-26 17:15:25,381] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved experiments/Cheatsheet-cifar10-vit_base_patch8_224-CS_SIZE_8-GlobalBatch128-RandomizeSheet/checkpoints/10/mp_rank_00_model_states.pt.
[2023-10-26 17:15:25,384] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving experiments/Cheatsheet-cifar10-vit_base_patch8_224-CS_SIZE_8-GlobalBatch128-RandomizeSheet/checkpoints/10/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2023-10-26 17:15:25,384] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving experiments/Cheatsheet-cifar10-vit_base_patch8_224-CS_SIZE_8-GlobalBatch128-RandomizeSheet/checkpoints/10/bf16_zero_pp_rank_7_mp_rank_00_optim_states.pt...
[2023-10-26 17:15:25,384] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving experiments/Cheatsheet-cifar10-vit_base_patch8_224-CS_SIZE_8-GlobalBatch128-RandomizeSheet/checkpoints/10/bf16_zero_pp_rank_5_mp_rank_00_optim_states.pt...
[2023-10-26 17:15:25,384] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving experiments/Cheatsheet-cifar10-vit_base_patch8_224-CS_SIZE_8-GlobalBatch128-RandomizeSheet/checkpoints/10/bf16_zero_pp_rank_4_mp_rank_00_optim_states.pt...
[2023-10-26 17:15:25,384] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving experiments/Cheatsheet-cifar10-vit_base_patch8_224-CS_SIZE_8-GlobalBatch128-RandomizeSheet/checkpoints/10/bf16_zero_pp_rank_6_mp_rank_00_optim_states.pt...
[2023-10-26 17:15:25,384] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving experiments/Cheatsheet-cifar10-vit_base_patch8_224-CS_SIZE_8-GlobalBatch128-RandomizeSheet/checkpoints/10/bf16_zero_pp_rank_1_mp_rank_00_optim_states.pt...
[2023-10-26 17:15:25,384] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving experiments/Cheatsheet-cifar10-vit_base_patch8_224-CS_SIZE_8-GlobalBatch128-RandomizeSheet/checkpoints/10/bf16_zero_pp_rank_2_mp_rank_00_optim_states.pt...
[2023-10-26 17:15:25,384] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving experiments/Cheatsheet-cifar10-vit_base_patch8_224-CS_SIZE_8-GlobalBatch128-RandomizeSheet/checkpoints/10/bf16_zero_pp_rank_3_mp_rank_00_optim_states.pt...
[2023-10-26 17:15:25,571] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved experiments/Cheatsheet-cifar10-vit_base_patch8_224-CS_SIZE_8-GlobalBatch128-RandomizeSheet/checkpoints/10/bf16_zero_pp_rank_5_mp_rank_00_optim_states.pt.
[2023-10-26 17:15:25,571] [INFO] [engine.py:3381:_save_zero_checkpoint] bf16_zero checkpoint saved experiments/Cheatsheet-cifar10-vit_base_patch8_224-CS_SIZE_8-GlobalBatch128-RandomizeSheet/checkpoints/10/bf16_zero_pp_rank_5_mp_rank_00_optim_states.pt
[2023-10-26 17:15:25,571] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint 10 is ready now!
[2023-10-26 17:15:25,577] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved experiments/Cheatsheet-cifar10-vit_base_patch8_224-CS_SIZE_8-GlobalBatch128-RandomizeSheet/checkpoints/10/bf16_zero_pp_rank_1_mp_rank_00_optim_states.pt.
[2023-10-26 17:15:25,577] [INFO] [engine.py:3381:_save_zero_checkpoint] bf16_zero checkpoint saved experiments/Cheatsheet-cifar10-vit_base_patch8_224-CS_SIZE_8-GlobalBatch128-RandomizeSheet/checkpoints/10/bf16_zero_pp_rank_1_mp_rank_00_optim_states.pt
[2023-10-26 17:15:25,577] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint 10 is ready now!
[2023-10-26 17:15:25,580] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved experiments/Cheatsheet-cifar10-vit_base_patch8_224-CS_SIZE_8-GlobalBatch128-RandomizeSheet/checkpoints/10/bf16_zero_pp_rank_4_mp_rank_00_optim_states.pt.
[2023-10-26 17:15:25,580] [INFO] [engine.py:3381:_save_zero_checkpoint] bf16_zero checkpoint saved experiments/Cheatsheet-cifar10-vit_base_patch8_224-CS_SIZE_8-GlobalBatch128-RandomizeSheet/checkpoints/10/bf16_zero_pp_rank_4_mp_rank_00_optim_states.pt
[2023-10-26 17:15:25,580] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint 10 is ready now!
[2023-10-26 17:15:25,593] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved experiments/Cheatsheet-cifar10-vit_base_patch8_224-CS_SIZE_8-GlobalBatch128-RandomizeSheet/checkpoints/10/bf16_zero_pp_rank_6_mp_rank_00_optim_states.pt.
[2023-10-26 17:15:25,594] [INFO] [engine.py:3381:_save_zero_checkpoint] bf16_zero checkpoint saved experiments/Cheatsheet-cifar10-vit_base_patch8_224-CS_SIZE_8-GlobalBatch128-RandomizeSheet/checkpoints/10/bf16_zero_pp_rank_6_mp_rank_00_optim_states.pt
[2023-10-26 17:15:25,594] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint 10 is ready now!
[2023-10-26 17:15:25,597] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved experiments/Cheatsheet-cifar10-vit_base_patch8_224-CS_SIZE_8-GlobalBatch128-RandomizeSheet/checkpoints/10/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2023-10-26 17:15:25,598] [INFO] [engine.py:3381:_save_zero_checkpoint] bf16_zero checkpoint saved experiments/Cheatsheet-cifar10-vit_base_patch8_224-CS_SIZE_8-GlobalBatch128-RandomizeSheet/checkpoints/10/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt
[2023-10-26 17:15:25,598] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint 10 is ready now!
[2023-10-26 17:15:25,599] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved experiments/Cheatsheet-cifar10-vit_base_patch8_224-CS_SIZE_8-GlobalBatch128-RandomizeSheet/checkpoints/10/bf16_zero_pp_rank_7_mp_rank_00_optim_states.pt.
[2023-10-26 17:15:25,599] [INFO] [engine.py:3381:_save_zero_checkpoint] bf16_zero checkpoint saved experiments/Cheatsheet-cifar10-vit_base_patch8_224-CS_SIZE_8-GlobalBatch128-RandomizeSheet/checkpoints/10/bf16_zero_pp_rank_7_mp_rank_00_optim_states.pt
[2023-10-26 17:15:25,599] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint 10 is ready now!
[2023-10-26 17:15:25,622] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved experiments/Cheatsheet-cifar10-vit_base_patch8_224-CS_SIZE_8-GlobalBatch128-RandomizeSheet/checkpoints/10/bf16_zero_pp_rank_3_mp_rank_00_optim_states.pt.
[2023-10-26 17:15:25,623] [INFO] [engine.py:3381:_save_zero_checkpoint] bf16_zero checkpoint saved experiments/Cheatsheet-cifar10-vit_base_patch8_224-CS_SIZE_8-GlobalBatch128-RandomizeSheet/checkpoints/10/bf16_zero_pp_rank_3_mp_rank_00_optim_states.pt
[2023-10-26 17:15:25,623] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint 10 is ready now!
[2023-10-26 17:15:25,626] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved experiments/Cheatsheet-cifar10-vit_base_patch8_224-CS_SIZE_8-GlobalBatch128-RandomizeSheet/checkpoints/10/bf16_zero_pp_rank_2_mp_rank_00_optim_states.pt.
[2023-10-26 17:15:25,627] [INFO] [engine.py:3381:_save_zero_checkpoint] bf16_zero checkpoint saved experiments/Cheatsheet-cifar10-vit_base_patch8_224-CS_SIZE_8-GlobalBatch128-RandomizeSheet/checkpoints/10/bf16_zero_pp_rank_2_mp_rank_00_optim_states.pt
[2023-10-26 17:15:25,627] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint 10 is ready now!
=========================
Validation loss:  tensor(3.1913e-06, device='cuda:0')
=========================
wandb: Adding directory to artifact (./experiments/Cheatsheet-cifar10-vit_base_patch8_224-CS_SIZE_8-GlobalBatch128-RandomizeSheet/saliency_maps)... Done. 0.1s
[tensor(9), tensor(8), tensor(2), tensor(9), tensor(8), tensor(1), tensor(0), tensor(0), tensor(5), tensor(5), tensor(9), tensor(6), tensor(0), tensor(3), tensor(8), tensor(3), tensor(2), tensor(2), tensor(1), tensor(6), tensor(8), tensor(4), tensor(3), tensor(9), tensor(7), tensor(9), tensor(8), tensor(4), tensor(7), tensor(4), tensor(7), tensor(7), tensor(6), tensor(4), tensor(8), tensor(6), tensor(2), tensor(7), tensor(5), tensor(0), tensor(9), tensor(3), tensor(7), tensor(1), tensor(2), tensor(8), tensor(4), tensor(2), tensor(3), tensor(2), tensor(5), tensor(0), tensor(1), tensor(6), tensor(0), tensor(5), tensor(9), tensor(8), tensor(2), tensor(3), tensor(5), tensor(1), tensor(7), tensor(4), tensor(0), tensor(6), tensor(0), tensor(1), tensor(0), tensor(6), tensor(9), tensor(8), tensor(0), tensor(2), tensor(7), tensor(7), tensor(7), tensor(2), tensor(9), tensor(1), tensor(3), tensor(0), tensor(0), tensor(3), tensor(7), tensor(6), tensor(9), tensor(9), tensor(9), tensor(4), tensor(7), tensor(3), tensor(2), tensor(8), tensor(4), tensor(6), tensor(0), tensor(7), tensor(1), tensor(0), tensor(6), tensor(1), tensor(3), tensor(1), tensor(0), tensor(3), tensor(6), tensor(0), tensor(9), tensor(7), tensor(4), tensor(2), tensor(1), tensor(2), tensor(5), tensor(8), tensor(5), tensor(5), tensor(4), tensor(5), tensor(0), tensor(8), tensor(6), tensor(0), tensor(1), tensor(7), tensor(2), tensor(1)]
Accuracy of plane : 100 %
Accuracy of   car : 100 %
Accuracy of  bird : 100 %
Accuracy of   cat : 100 %
Accuracy of  deer : 100 %
Accuracy of   dog : 100 %
Accuracy of  frog : 100 %
Accuracy of horse : 100 %
Accuracy of  ship : 100 %
Accuracy of truck : 100 %
Total accuracy:  100.0%
[2023-10-26 17:15:32,924] [INFO] [logging.py:96:log_dist] [Rank 0] step=550, skipped=0, lr=[9.134542298314146e-05], mom=[[0.9, 0.999]]
[2023-10-26 17:15:32,926] [INFO] [timer.py:260:stop] epoch=0/micro_step=550/global_step=550, RunningAvgSamplesPerSec=1770.262751611846, CurrSamplesPerSec=1801.8220969257618, MemAllocated=0.83GB, MaxMemAllocated=4.94GB
[2023-10-26 17:15:34,817] [INFO] [logging.py:96:log_dist] [Rank 0] step=575, skipped=0, lr=[9.198892815632103e-05], mom=[[0.9, 0.999]]
[2023-10-26 17:15:34,819] [INFO] [timer.py:260:stop] epoch=0/micro_step=575/global_step=575, RunningAvgSamplesPerSec=1771.730646541406, CurrSamplesPerSec=1818.2680371869337, MemAllocated=0.83GB, MaxMemAllocated=4.94GB
=========================
Validation loss:  tensor(2.6760e-06, device='cuda:0')
=========================
wandb: Adding directory to artifact (./experiments/Cheatsheet-cifar10-vit_base_patch8_224-CS_SIZE_8-GlobalBatch128-RandomizeSheet/saliency_maps)... Done. 0.1s
[tensor(3), tensor(7), tensor(1), tensor(7), tensor(9), tensor(8), tensor(1), tensor(9), tensor(9), tensor(5), tensor(7), tensor(0), tensor(2), tensor(2), tensor(6), tensor(8), tensor(5), tensor(2), tensor(4), tensor(0), tensor(5), tensor(8), tensor(7), tensor(0), tensor(0), tensor(8), tensor(9), tensor(2), tensor(1), tensor(6), tensor(5), tensor(6), tensor(7), tensor(7), tensor(6), tensor(9), tensor(9), tensor(1), tensor(3), tensor(6), tensor(6), tensor(1), tensor(2), tensor(2), tensor(7), tensor(3), tensor(1), tensor(0), tensor(8), tensor(6), tensor(5), tensor(8), tensor(4), tensor(3), tensor(7), tensor(2), tensor(6), tensor(2), tensor(6), tensor(3), tensor(7), tensor(0), tensor(6), tensor(3), tensor(1), tensor(2), tensor(8), tensor(7), tensor(9), tensor(2), tensor(8), tensor(5), tensor(3), tensor(7), tensor(7), tensor(8), tensor(0), tensor(3), tensor(4), tensor(9), tensor(9), tensor(1), tensor(1), tensor(5), tensor(2), tensor(1), tensor(5), tensor(4), tensor(6), tensor(8), tensor(3), tensor(4), tensor(8), tensor(2), tensor(5), tensor(5), tensor(6), tensor(5), tensor(8), tensor(1), tensor(3), tensor(2), tensor(4), tensor(7), tensor(6), tensor(7), tensor(3), tensor(1), tensor(6), tensor(0), tensor(2), tensor(3), tensor(9), tensor(0), tensor(4), tensor(7), tensor(2), tensor(9), tensor(4), tensor(0), tensor(9), tensor(1), tensor(1), tensor(3), tensor(5), tensor(7), tensor(2), tensor(9)]
Accuracy of plane : 100 %
Accuracy of   car : 100 %
Accuracy of  bird : 100 %
Accuracy of   cat : 100 %
Accuracy of  deer : 100 %
Accuracy of   dog : 100 %
Accuracy of  frog : 100 %
Accuracy of horse : 100 %
Accuracy of  ship : 100 %
Accuracy of truck : 100 %
Total accuracy:  100.0%
[2023-10-26 17:15:42,526] [INFO] [logging.py:96:log_dist] [Rank 0] step=600, skipped=0, lr=[9.26050416794548e-05], mom=[[0.9, 0.999]]
[2023-10-26 17:15:42,528] [INFO] [timer.py:260:stop] epoch=0/micro_step=600/global_step=600, RunningAvgSamplesPerSec=1769.6243436835477, CurrSamplesPerSec=1827.8883392178025, MemAllocated=0.83GB, MaxMemAllocated=4.94GB
=========================
Validation loss:  tensor(2.2762e-06, device='cuda:0')
=========================
wandb: Adding directory to artifact (./experiments/Cheatsheet-cifar10-vit_base_patch8_224-CS_SIZE_8-GlobalBatch128-RandomizeSheet/saliency_maps)... Done. 0.1s
[tensor(9), tensor(7), tensor(7), tensor(2), tensor(1), tensor(1), tensor(9), tensor(0), tensor(1), tensor(9), tensor(4), tensor(4), tensor(6), tensor(5), tensor(6), tensor(6), tensor(1), tensor(0), tensor(6), tensor(4), tensor(8), tensor(5), tensor(3), tensor(0), tensor(2), tensor(9), tensor(9), tensor(3), tensor(2), tensor(7), tensor(1), tensor(8), tensor(1), tensor(2), tensor(3), tensor(4), tensor(2), tensor(5), tensor(2), tensor(4), tensor(1), tensor(7), tensor(2), tensor(9), tensor(9), tensor(0), tensor(3), tensor(4), tensor(1), tensor(4), tensor(5), tensor(5), tensor(4), tensor(4), tensor(0), tensor(2), tensor(6), tensor(1), tensor(7), tensor(6), tensor(0), tensor(9), tensor(2), tensor(2), tensor(9), tensor(7), tensor(5), tensor(4), tensor(3), tensor(0), tensor(5), tensor(2), tensor(5), tensor(4), tensor(2), tensor(6), tensor(2), tensor(8), tensor(3), tensor(5), tensor(0), tensor(9), tensor(2), tensor(1), tensor(1), tensor(1), tensor(5), tensor(6), tensor(2), tensor(6), tensor(8), tensor(6), tensor(4), tensor(8), tensor(2), tensor(7), tensor(7), tensor(0), tensor(4), tensor(3), tensor(6), tensor(5), tensor(9), tensor(3), tensor(4), tensor(6), tensor(8), tensor(9), tensor(2), tensor(9), tensor(6), tensor(0), tensor(7), tensor(6), tensor(8), tensor(4), tensor(4), tensor(7), tensor(7), tensor(4), tensor(6), tensor(6), tensor(4), tensor(9), tensor(8), tensor(9), tensor(1), tensor(9)]
Accuracy of plane : 100 %
Accuracy of   car : 100 %
Accuracy of  bird : 100 %
Accuracy of   cat : 100 %
Accuracy of  deer : 100 %
Accuracy of   dog : 100 %
Accuracy of  frog : 100 %
Accuracy of horse : 100 %
Accuracy of  ship : 100 %
Accuracy of truck : 100 %
Total accuracy:  100.0%
[2023-10-26 17:15:50,192] [INFO] [logging.py:96:log_dist] [Rank 0] step=625, skipped=0, lr=[9.319600057813584e-05], mom=[[0.9, 0.999]]
[2023-10-26 17:15:50,194] [INFO] [timer.py:260:stop] epoch=0/micro_step=625/global_step=625, RunningAvgSamplesPerSec=1771.2184149797488, CurrSamplesPerSec=1354.7014953242729, MemAllocated=0.84GB, MaxMemAllocated=4.95GB
[2023-10-26 17:15:52,098] [INFO] [logging.py:96:log_dist] [Rank 0] step=650, skipped=0, lr=[9.376377855476186e-05], mom=[[0.9, 0.999]]
[2023-10-26 17:15:52,100] [INFO] [timer.py:260:stop] epoch=0/micro_step=650/global_step=650, RunningAvgSamplesPerSec=1771.1664851236255, CurrSamplesPerSec=1838.4919782067482, MemAllocated=0.84GB, MaxMemAllocated=4.95GB
=========================
Validation loss:  tensor(1.9527e-06, device='cuda:0')
=========================
wandb: Adding directory to artifact (./experiments/Cheatsheet-cifar10-vit_base_patch8_224-CS_SIZE_8-GlobalBatch128-RandomizeSheet/saliency_maps)... Done. 0.1s
[tensor(2), tensor(1), tensor(0), tensor(9), tensor(6), tensor(5), tensor(8), tensor(7), tensor(7), tensor(5), tensor(6), tensor(5), tensor(8), tensor(7), tensor(8), tensor(9), tensor(9), tensor(8), tensor(4), tensor(8), tensor(9), tensor(3), tensor(3), tensor(6), tensor(5), tensor(1), tensor(1), tensor(8), tensor(1), tensor(2), tensor(7), tensor(0), tensor(1), tensor(8), tensor(5), tensor(6), tensor(4), tensor(2), tensor(4), tensor(5), tensor(6), tensor(7), tensor(0), tensor(4), tensor(0), tensor(5), tensor(8), tensor(1), tensor(7), tensor(1), tensor(7), tensor(5), tensor(5), tensor(7), tensor(7), tensor(5), tensor(9), tensor(0), tensor(2), tensor(4), tensor(6), tensor(0), tensor(0), tensor(6), tensor(9), tensor(9), tensor(1), tensor(6), tensor(2), tensor(0), tensor(7), tensor(1), tensor(8), tensor(0), tensor(4), tensor(2), tensor(4), tensor(6), tensor(4), tensor(6), tensor(2), tensor(4), tensor(8), tensor(1), tensor(8), tensor(7), tensor(3), tensor(6), tensor(0), tensor(4), tensor(9), tensor(4), tensor(8), tensor(9), tensor(8), tensor(3), tensor(7), tensor(0), tensor(6), tensor(1), tensor(7), tensor(9), tensor(2), tensor(9), tensor(4), tensor(6), tensor(0), tensor(5), tensor(3), tensor(1), tensor(8), tensor(8), tensor(3), tensor(4), tensor(7), tensor(0), tensor(5), tensor(8), tensor(8), tensor(4), tensor(2), tensor(7), tensor(9), tensor(2), tensor(8), tensor(0), tensor(6), tensor(3)]
Accuracy of plane : 100 %
Accuracy of   car : 100 %
Accuracy of  bird : 100 %
Accuracy of   cat : 100 %
Accuracy of  deer : 100 %
Accuracy of   dog : 100 %
Accuracy of  frog : 100 %
Accuracy of horse : 100 %
Accuracy of  ship : 100 %
Accuracy of truck : 100 %
Total accuracy:  100.0%
[2023-10-26 17:15:59,739] [INFO] [logging.py:96:log_dist] [Rank 0] step=675, skipped=0, lr=[9.431012576103418e-05], mom=[[0.9, 0.999]]
[2023-10-26 17:15:59,741] [INFO] [timer.py:260:stop] epoch=0/micro_step=675/global_step=675, RunningAvgSamplesPerSec=1771.196234547726, CurrSamplesPerSec=1387.1665594390056, MemAllocated=0.84GB, MaxMemAllocated=4.96GB
[2023-10-26 17:16:01,619] [INFO] [logging.py:96:log_dist] [Rank 0] step=700, skipped=0, lr=[9.483660133380856e-05], mom=[[0.9, 0.999]]
[2023-10-26 17:16:01,621] [INFO] [timer.py:260:stop] epoch=0/micro_step=700/global_step=700, RunningAvgSamplesPerSec=1772.5555017049458, CurrSamplesPerSec=1818.4774363125823, MemAllocated=0.84GB, MaxMemAllocated=4.96GB
=========================
Validation loss:  tensor(1.7366e-06, device='cuda:0')
=========================
wandb: Adding directory to artifact (./experiments/Cheatsheet-cifar10-vit_base_patch8_224-CS_SIZE_8-GlobalBatch128-RandomizeSheet/saliency_maps)... Done. 0.1s
[tensor(4), tensor(7), tensor(7), tensor(3), tensor(9), tensor(1), tensor(5), tensor(8), tensor(5), tensor(9), tensor(0), tensor(0), tensor(8), tensor(6), tensor(8), tensor(6), tensor(3), tensor(4), tensor(0), tensor(0), tensor(0), tensor(3), tensor(0), tensor(8), tensor(5), tensor(7), tensor(5), tensor(0), tensor(6), tensor(0), tensor(9), tensor(6), tensor(5), tensor(4), tensor(2), tensor(5), tensor(0), tensor(8), tensor(5), tensor(3), tensor(3), tensor(5), tensor(6), tensor(8), tensor(9), tensor(7), tensor(0), tensor(6), tensor(4), tensor(9), tensor(1), tensor(2), tensor(7), tensor(7), tensor(0), tensor(3), tensor(8), tensor(8), tensor(3), tensor(0), tensor(2), tensor(0), tensor(2), tensor(7), tensor(8), tensor(8), tensor(0), tensor(2), tensor(8), tensor(3), tensor(8), tensor(0), tensor(6), tensor(8), tensor(1), tensor(9), tensor(7), tensor(2), tensor(4), tensor(1), tensor(2), tensor(2), tensor(5), tensor(2), tensor(8), tensor(8), tensor(0), tensor(1), tensor(5), tensor(6), tensor(2), tensor(4), tensor(0), tensor(2), tensor(6), tensor(3), tensor(2), tensor(1), tensor(6), tensor(6), tensor(7), tensor(8), tensor(0), tensor(6), tensor(5), tensor(5), tensor(1), tensor(2), tensor(5), tensor(5), tensor(7), tensor(0), tensor(3), tensor(3), tensor(7), tensor(8), tensor(3), tensor(3), tensor(5), tensor(0), tensor(3), tensor(7), tensor(4), tensor(8), tensor(5), tensor(3), tensor(9), tensor(9)]
Accuracy of plane : 100 %
Accuracy of   car : 100 %
Accuracy of  bird : 100 %
Accuracy of   cat : 100 %
Accuracy of  deer : 100 %
Accuracy of   dog : 100 %
Accuracy of  frog : 100 %
Accuracy of horse : 100 %
Accuracy of  ship : 100 %
Accuracy of truck : 100 %
Total accuracy:  100.0%
[2023-10-26 17:16:09,296] [INFO] [logging.py:96:log_dist] [Rank 0] step=725, skipped=0, lr=[9.534460021903313e-05], mom=[[0.9, 0.999]]
[2023-10-26 17:16:09,298] [INFO] [timer.py:260:stop] epoch=0/micro_step=725/global_step=725, RunningAvgSamplesPerSec=1772.7616783329192, CurrSamplesPerSec=1838.592717148229, MemAllocated=0.85GB, MaxMemAllocated=4.96GB
[2023-10-26 17:16:11,182] [INFO] [logging.py:96:log_dist] [Rank 0] step=750, skipped=0, lr=[9.583537544639001e-05], mom=[[0.9, 0.999]]
[2023-10-26 17:16:11,184] [INFO] [timer.py:260:stop] epoch=0/micro_step=750/global_step=750, RunningAvgSamplesPerSec=1773.8753053774885, CurrSamplesPerSec=1825.6134005719591, MemAllocated=0.85GB, MaxMemAllocated=4.96GB
=========================
Validation loss:  tensor(1.4479e-06, device='cuda:0')
=========================
wandb: Adding directory to artifact (./experiments/Cheatsheet-cifar10-vit_base_patch8_224-CS_SIZE_8-GlobalBatch128-RandomizeSheet/saliency_maps)... Done. 0.1s
[tensor(8), tensor(4), tensor(2), tensor(3), tensor(7), tensor(4), tensor(8), tensor(1), tensor(1), tensor(8), tensor(2), tensor(4), tensor(9), tensor(1), tensor(4), tensor(4), tensor(4), tensor(0), tensor(6), tensor(5), tensor(6), tensor(1), tensor(8), tensor(5), tensor(9), tensor(5), tensor(5), tensor(4), tensor(8), tensor(7), tensor(1), tensor(5), tensor(7), tensor(7), tensor(3), tensor(5), tensor(9), tensor(8), tensor(7), tensor(1), tensor(9), tensor(1), tensor(8), tensor(1), tensor(0), tensor(2), tensor(9), tensor(4), tensor(2), tensor(0), tensor(5), tensor(7), tensor(8), tensor(7), tensor(1), tensor(7), tensor(8), tensor(2), tensor(7), tensor(8), tensor(7), tensor(7), tensor(3), tensor(2), tensor(4), tensor(4), tensor(7), tensor(2), tensor(8), tensor(2), tensor(0), tensor(4), tensor(7), tensor(3), tensor(2), tensor(7), tensor(4), tensor(3), tensor(0), tensor(8), tensor(9), tensor(9), tensor(8), tensor(6), tensor(3), tensor(9), tensor(5), tensor(6), tensor(4), tensor(1), tensor(5), tensor(8), tensor(6), tensor(8), tensor(3), tensor(3), tensor(3), tensor(8), tensor(6), tensor(7), tensor(7), tensor(2), tensor(9), tensor(8), tensor(9), tensor(9), tensor(8), tensor(3), tensor(5), tensor(2), tensor(8), tensor(9), tensor(4), tensor(1), tensor(1), tensor(1), tensor(8), tensor(0), tensor(3), tensor(8), tensor(8), tensor(7), tensor(1), tensor(5), tensor(2), tensor(5), tensor(6), tensor(0)]
Accuracy of plane : 100 %
Accuracy of   car : 100 %
Accuracy of  bird : 100 %
Accuracy of   cat : 100 %
Accuracy of  deer : 100 %
Accuracy of   dog : 100 %
Accuracy of  frog : 100 %
Accuracy of horse : 100 %
Accuracy of  ship : 100 %
Accuracy of truck : 100 %
Total accuracy:  100.0%
[2023-10-26 17:16:18,883] [INFO] [logging.py:96:log_dist] [Rank 0] step=775, skipped=0, lr=[9.631005675021036e-05], mom=[[0.9, 0.999]]
[2023-10-26 17:16:18,885] [INFO] [timer.py:260:stop] epoch=0/micro_step=775/global_step=775, RunningAvgSamplesPerSec=1774.4180435775443, CurrSamplesPerSec=1803.5290212914626, MemAllocated=0.85GB, MaxMemAllocated=4.97GB
[2023-10-26 17:16:20,774] [INFO] [logging.py:96:log_dist] [Rank 0] step=800, skipped=0, lr=[9.676966623306479e-05], mom=[[0.9, 0.999]]
[2023-10-26 17:16:20,776] [INFO] [timer.py:260:stop] epoch=0/micro_step=800/global_step=800, RunningAvgSamplesPerSec=1774.9141133120684, CurrSamplesPerSec=1761.1852707202256, MemAllocated=0.85GB, MaxMemAllocated=4.97GB
=========================
Validation loss:  tensor(1.2666e-06, device='cuda:0')
=========================
wandb: Adding directory to artifact (./experiments/Cheatsheet-cifar10-vit_base_patch8_224-CS_SIZE_8-GlobalBatch128-RandomizeSheet/saliency_maps)... Done. 0.1s
[tensor(3), tensor(3), tensor(1), tensor(7), tensor(9), tensor(2), tensor(6), tensor(5), tensor(4), tensor(4), tensor(2), tensor(0), tensor(2), tensor(7), tensor(9), tensor(9), tensor(0), tensor(0), tensor(5), tensor(9), tensor(4), tensor(5), tensor(1), tensor(5), tensor(3), tensor(0), tensor(3), tensor(3), tensor(4), tensor(1), tensor(4), tensor(5), tensor(1), tensor(2), tensor(5), tensor(8), tensor(7), tensor(1), tensor(4), tensor(7), tensor(8), tensor(5), tensor(3), tensor(7), tensor(7), tensor(2), tensor(9), tensor(7), tensor(9), tensor(8), tensor(5), tensor(5), tensor(0), tensor(4), tensor(8), tensor(9), tensor(9), tensor(0), tensor(7), tensor(4), tensor(0), tensor(8), tensor(6), tensor(9), tensor(2), tensor(9), tensor(4), tensor(1), tensor(1), tensor(9), tensor(0), tensor(5), tensor(3), tensor(8), tensor(7), tensor(5), tensor(9), tensor(2), tensor(0), tensor(6), tensor(2), tensor(9), tensor(6), tensor(9), tensor(8), tensor(6), tensor(6), tensor(5), tensor(2), tensor(3), tensor(1), tensor(6), tensor(1), tensor(5), tensor(5), tensor(9), tensor(1), tensor(8), tensor(5), tensor(0), tensor(9), tensor(7), tensor(9), tensor(7), tensor(3), tensor(4), tensor(8), tensor(0), tensor(2), tensor(6), tensor(0), tensor(0), tensor(0), tensor(5), tensor(1), tensor(0), tensor(5), tensor(5), tensor(6), tensor(7), tensor(2), tensor(9), tensor(7), tensor(9), tensor(4), tensor(2), tensor(3), tensor(0)]
Accuracy of plane : 100 %
Accuracy of   car : 100 %
Accuracy of  bird : 100 %
Accuracy of   cat : 100 %
Accuracy of  deer : 100 %
Accuracy of   dog : 100 %
Accuracy of  frog : 100 %
Accuracy of horse : 100 %
Accuracy of  ship : 100 %
Accuracy of truck : 100 %
Total accuracy:  100.0%
[2023-10-26 17:16:28,446] [INFO] [logging.py:96:log_dist] [Rank 0] step=825, skipped=0, lr=[9.721513161833084e-05], mom=[[0.9, 0.999]]
[2023-10-26 17:16:28,448] [INFO] [timer.py:260:stop] epoch=0/micro_step=825/global_step=825, RunningAvgSamplesPerSec=1772.7795172764236, CurrSamplesPerSec=1711.0496387446735, MemAllocated=0.85GB, MaxMemAllocated=4.97GB
[2023-10-26 17:16:30,334] [INFO] [logging.py:96:log_dist] [Rank 0] step=850, skipped=0, lr=[9.764729752380978e-05], mom=[[0.9, 0.999]]
[2023-10-26 17:16:30,336] [INFO] [timer.py:260:stop] epoch=0/micro_step=850/global_step=850, RunningAvgSamplesPerSec=1773.7712476968013, CurrSamplesPerSec=1845.7608185184295, MemAllocated=0.85GB, MaxMemAllocated=4.97GB
=========================
Validation loss:  tensor(1.0977e-06, device='cuda:0')
=========================
